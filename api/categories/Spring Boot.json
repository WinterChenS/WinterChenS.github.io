{"name":"Spring Boot","postlist":[{"title":"向日葵","slug":"2018-08-20-summer-sunflower","date":"2018-08-12T11:54:00.000Z","updated":"2022-12-01T01:32:39.783Z","comments":true,"top":null,"path":"api/articles/2018-08-20-summer-sunflower.json","excerpt":null,"keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046642584319.jpg","content":"<p>台风天的向日葵</p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046644425654.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046646280274.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046646700905.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046647490901.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046648249786.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046648922345.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046649741419.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n","raw":null,"categories":[{"name":"Spring Boot","path":"api/categories/Spring Boot.json"}],"tags":[{"name":"随笔","path":"api/tags/随笔.json"}]},{"title":"Spring boot Mybatis 整合（注解版）","slug":"spring-boot-mybatis-annotation","date":"2018-01-18T13:40:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/spring-boot-mybatis-annotation.json","excerpt":" [Figure]   之前写过一篇关于springboot 与 mybatis整合的博文，使用了一段时间spring-data-jpa，发现那种方式真的是太爽了，mybatis的xml的映射配置总觉得有点麻烦。接口定义和映射离散在不同的文件中，阅读起来不是很方便。于是，准备使用mybatis的注解方式实现映射。如果喜欢xml方式的可以看我之前的博文： Spring boot Mybatis 整合（完整版）","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046777967495.jpg","content":"<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046778152150.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<blockquote>\n<p>  之前写过一篇关于springboot 与 mybatis整合的博文，使用了一段时间<a href=\"http://winterchen.com/2017/11/11/springbootdata2/\" target=\"_blank\" rel=\"noopener\">spring-data-jpa</a>，发现那种方式真的是太爽了，mybatis的xml的映射配置总觉得有点麻烦。接口定义和映射离散在不同的文件中，阅读起来不是很方便。于是，准备使用mybatis的注解方式实现映射。如果喜欢xml方式的可以看我之前的博文：<a href=\"http://blog.csdn.net/winter_chen001/article/details/77249029\" target=\"_blank\" rel=\"noopener\"> Spring boot Mybatis 整合（完整版）</a></p>\n</blockquote>\n<a id=\"more\"></a>\n<h3 id=\"源码\"><a href=\"#源码\" class=\"headerlink\" title=\"源码\"></a>源码</h3><p>请前往文章末端查看</p>\n<h3 id=\"开发环境：\"><a href=\"#开发环境：\" class=\"headerlink\" title=\"开发环境：\"></a>开发环境：</h3><hr>\n<ul>\n<li>开发工具：Intellij IDEA 2017.1.3</li>\n<li>JDK : 1.8.0_101</li>\n<li>spring boot 版本 ： 1.5.8.RELEASE</li>\n<li>maven : 3.3.9</li>\n</ul>\n<h3 id=\"拓展：\"><a href=\"#拓展：\" class=\"headerlink\" title=\"拓展：\"></a>拓展：</h3><ul>\n<li>springboot 整合 Mybatis 事务管理</li>\n</ul>\n<h3 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h3><h4 id=\"1-新建一个springboot项目：\"><a href=\"#1-新建一个springboot项目：\" class=\"headerlink\" title=\"1.新建一个springboot项目：\"></a>1.新建一个springboot项目：</h4><p><img    class=\"lazyload\" data-original=\"http://img.blog.csdn.net/20171124094443907?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvV2ludGVyX2NoZW4wMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p><img    class=\"lazyload\" data-original=\"http://img.blog.csdn.net/20171124094505295?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvV2ludGVyX2NoZW4wMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p><strong>添加依赖</strong><br><img    class=\"lazyload\" data-original=\"http://img.blog.csdn.net/20171124094516207?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvV2ludGVyX2NoZW4wMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<h4 id=\"2-看一下项目结构\"><a href=\"#2-看一下项目结构\" class=\"headerlink\" title=\"2.看一下项目结构\"></a>2.看一下项目结构</h4><p><img    class=\"lazyload\" data-original=\"http://img.blog.csdn.net/20171124094524448?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvV2ludGVyX2NoZW4wMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<h4 id=\"3-完整依赖\"><a href=\"#3-完整依赖\" class=\"headerlink\" title=\"3.完整依赖\"></a>3.完整依赖</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project</span> <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://maven.apache.org/POM/4.0.0\"</span> <span class=\"hljs-attr\">xmlns:xsi</span>=<span class=\"hljs-string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">xsi:schemaLocation</span>=<span class=\"hljs-string\">\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">modelVersion</span>&gt;</span>4.0.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">modelVersion</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.winterchen<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>springboot-mybatis-demo2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">packaging</span>&gt;</span>jar<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">packaging</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">name</span>&gt;</span>springboot-mybatis-demo2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">name</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">description</span>&gt;</span>Demo project for Spring Boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">description</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">parent</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.5.8.RELEASE<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">relativePath</span>/&gt;</span> <span class=\"hljs-comment\">&lt;!-- lookup parent from repository --&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">parent</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">properties</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project.build.sourceEncoding</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project.reporting.outputEncoding</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">java.version</span>&gt;</span>1.8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">java.version</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">properties</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.3.1<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>mysql<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>runtime<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">build</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">plugins</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">plugins</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">build</span>&gt;</span><br><br><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n\n<h4 id=\"4-配置文件\"><a href=\"#4-配置文件\" class=\"headerlink\" title=\"4.配置文件\"></a>4.配置文件</h4><p>因为习惯性的喜欢使用yml作为配置文件，所以将application.properties替换为application.yml</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yml\"><span class=\"hljs-attr\">spring:</span><br>  <span class=\"hljs-attr\">datasource:</span><br>     <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/mytest</span><br>     <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span><br>     <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span><br>     <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span><br></code></pre></td></tr></table></figure>\n\n<p>简单且简洁的完成了基本配置，下面看看我们是如何在这个基础下轻松使用Mybatis访问数据库的</p>\n<h3 id=\"使用Mybatis\"><a href=\"#使用Mybatis\" class=\"headerlink\" title=\"使用Mybatis\"></a>使用Mybatis</h3><hr>\n<ul>\n<li><p>在Mysql数据库中创建数据表：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">DATABASE</span> mytest;<br><br><span class=\"hljs-keyword\">USE</span> mytest;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> t_user(<br>  <span class=\"hljs-keyword\">id</span> <span class=\"hljs-built_in\">BIGINT</span> <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> PRIMARY <span class=\"hljs-keyword\">KEY</span> AUTO_INCREMENT,<br>  <span class=\"hljs-keyword\">name</span> <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> ,<br>  <span class=\"hljs-keyword\">password</span> <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> ,<br>  phone <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span><br>) <span class=\"hljs-keyword\">ENGINE</span>=<span class=\"hljs-keyword\">INNODB</span> AUTO_INCREMENT=<span class=\"hljs-number\">1000</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">CHARSET</span>=utf8;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>创建映射对象User</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.domain;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * User实体映射类</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2017/11/24.</span><br><span class=\"hljs-comment\"> */</span><br><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">User</span> </span>&#123;<br><br>    <span class=\"hljs-keyword\">private</span> Integer id;<br>    <span class=\"hljs-keyword\">private</span> String name;<br>    <span class=\"hljs-keyword\">private</span> String password;<br>    <span class=\"hljs-keyword\">private</span> String phone;<br><br>\t<span class=\"hljs-comment\">//省略 get 和 set ...</span><br>&#125;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>创建User映射的操作UserMapper，为了后续单元测试验证，实现插入和查询操作</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.mapper;<br><br><span class=\"hljs-keyword\">import</span> com.winterchen.domain.User;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.annotations.Insert;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.annotations.Mapper;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.annotations.Param;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.annotations.Select;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * User映射类</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2017/11/24.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Mapper</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">UserMapper</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Select</span>(<span class=\"hljs-string\">\"SELECT * FROM T_USER WHERE PHONE = #&#123;phone&#125;\"</span>)<br>    <span class=\"hljs-function\">User <span class=\"hljs-title\">findUserByPhone</span><span class=\"hljs-params\">(@Param(<span class=\"hljs-string\">\"phone\"</span>)</span> String phone)</span>;<br><br>    <span class=\"hljs-meta\">@Insert</span>(<span class=\"hljs-string\">\"INSERT INTO T_USER(NAME, PASSWORD, PHONE) VALUES(#&#123;name&#125;, #&#123;password&#125;, #&#123;phone&#125;)\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">insert</span><span class=\"hljs-params\">(@Param(<span class=\"hljs-string\">\"name\"</span>)</span> String name, @<span class=\"hljs-title\">Param</span><span class=\"hljs-params\">(<span class=\"hljs-string\">\"password\"</span>)</span> String password, @<span class=\"hljs-title\">Param</span><span class=\"hljs-params\">(<span class=\"hljs-string\">\"phone\"</span>)</span> String phone)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><strong>如果想了解更多Mybatis注解的详细：<a href=\"http://blog.csdn.net/winter_chen001/article/details/78623700\" target=\"_blank\" rel=\"noopener\">springboot中使用Mybatis注解配置详解</a></strong></p>\n<ul>\n<li><p>创建springboot 主类：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen;<br><br><span class=\"hljs-keyword\">import</span> org.springframework.boot.SpringApplication;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class=\"hljs-meta\">@SpringBootApplication</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">SpringbootMybatisDemo2Application</span> </span>&#123;<br><br>\t<span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span> </span>&#123;<br>\t\tSpringApplication.run(SpringbootMybatisDemo2Application<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>, <span class=\"hljs-title\">args</span>)</span>;<br>\t&#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n</li>\n<li><p>创建测试单元:</p>\n<ul>\n<li>测试逻辑：插入一条name为”weinterchen”的User，然后根据user的phone进行查询，并判断user的name是否为”winterchen”。</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen;<br><br><span class=\"hljs-keyword\">import</span> com.winterchen.domain.User;<br><span class=\"hljs-keyword\">import</span> com.winterchen.mapper.UserMapper;<br><span class=\"hljs-keyword\">import</span> org.junit.Assert;<br><span class=\"hljs-keyword\">import</span> org.junit.Test;<br><span class=\"hljs-keyword\">import</span> org.junit.runner.RunWith;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.test.context.SpringBootTest;<br><span class=\"hljs-keyword\">import</span> org.springframework.test.context.junit4.SpringRunner;<br><br><span class=\"hljs-meta\">@RunWith</span>(SpringRunner<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span><br><span class=\"hljs-class\">@<span class=\"hljs-title\">SpringBootTest</span></span><br><span class=\"hljs-class\"><span class=\"hljs-title\">public</span> <span class=\"hljs-title\">class</span> <span class=\"hljs-title\">SpringbootMybatisDemo2ApplicationTests</span> </span>&#123;<br><br><br>\t<span class=\"hljs-meta\">@Autowired</span><br>\t<span class=\"hljs-keyword\">private</span> UserMapper userMapper;<br><br>\t<span class=\"hljs-meta\">@Test</span><br>\t<span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">test</span><span class=\"hljs-params\">()</span></span>&#123;<br><br>\t\tuserMapper.insert(<span class=\"hljs-string\">\"winterchen\"</span>, <span class=\"hljs-string\">\"123456\"</span>, <span class=\"hljs-string\">\"12345678910\"</span>);<br>\t\tUser u = userMapper.findUserByPhone(<span class=\"hljs-string\">\"12345678910\"</span>);<br>\t\tAssert.assertEquals(<span class=\"hljs-string\">\"winterchen\"</span>, u.getName());<br>\t&#125;<br><br>\t<br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n<ul>\n<li>测试结果</li>\n</ul>\n<p><img    class=\"lazyload\" data-original=\"http://img.blog.csdn.net/20171124103725302?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvV2ludGVyX2NoZW4wMDE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p>说明已经成功了</p>\n<h3 id=\"事务管理（重要）\"><a href=\"#事务管理（重要）\" class=\"headerlink\" title=\"事务管理（重要）\"></a>事务管理（重要）</h3><hr>\n<blockquote>\n<p>我们在开发企业应用时，对于业务人员的一个操作实际是对数据读写的多步操作的结合。由于数据操作在顺序执行的过程中，任何一步操作都有可能发生异常，异常会导致后续操作无法完成，此时由于业务逻辑并未正确的完成，之前成功操作数据的并不可靠，需要在这种情况下进行回退。</p>\n</blockquote>\n<p><strong>为了测试的成功，请把测试的内容进行替换，因为之前测试的时候已经将数据生成了，重复的数据会对测试的结果有影响</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Test</span><br><span class=\"hljs-meta\">@Transactional</span><br><span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">test</span><span class=\"hljs-params\">()</span></span>&#123;<br><br>\tuserMapper.insert(<span class=\"hljs-string\">\"张三\"</span>, <span class=\"hljs-string\">\"123456\"</span>, <span class=\"hljs-string\">\"18600000000\"</span>);<br>\t<span class=\"hljs-keyword\">int</span> a = <span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">0</span>;<br>\tuserMapper.insert(<span class=\"hljs-string\">\"李四\"</span>, <span class=\"hljs-string\">\"123456\"</span>, <span class=\"hljs-string\">\"13500000000\"</span>);<br>\tUser u = userMapper.findUserByPhone(<span class=\"hljs-string\">\"12345678910\"</span>);<br>\tAssert.assertEquals(<span class=\"hljs-string\">\"winterchen\"</span>, u.getName());<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>只需要在需要事务管理的方法上添加 <code>@Transactional</code> 注解即可，然后我们启动测试，会发现异常之后，数据库中没有产生数据。</p>\n<p>如果大家想对springboot事务管理有更加详细的了解，欢迎大家查看：<a href=\"http://blog.csdn.net/Winter_chen001/article/details/78622679\" target=\"_blank\" rel=\"noopener\"> springboot事务管理详解</a></p>\n<p>源码：<a href=\"https://github.com/WinterChenS/springboot-mybatis-demo2/\" target=\"_blank\" rel=\"noopener\">https://github.com/WinterChenS/springboot-mybatis-demo2/</a></p>\n","raw":null,"categories":[{"name":"Spring Boot","path":"api/categories/Spring Boot.json"}],"tags":[{"name":"Spring Boot","path":"api/tags/Spring Boot.json"},{"name":"mybatis","path":"api/tags/mybatis.json"}]},{"title":"springboot整合mybatis 使用HikariCP连接池","slug":"spring-boot-mybatis-hikaricp","date":"2018-07-25T07:49:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/spring-boot-mybatis-hikaricp.json","excerpt":null,"keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046778695396.jpg","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Springboot让Java开发更加美好，本节主要讲的是使用Hikari数据库连接池，如果需要使用druid连接池的请看我另外一篇博客，<a href=\"https://blog.csdn.net/winter_chen001/article/details/80010967\" target=\"_blank\" rel=\"noopener\">springboot Mybatis 整合</a>（这篇文章有详细搭建springboot项目的过程，对于刚接触springboot的新手有帮助）。</p>\n<h3 id=\"为什么使用HikariCP\"><a href=\"#为什么使用HikariCP\" class=\"headerlink\" title=\"为什么使用HikariCP\"></a>为什么使用HikariCP</h3><p>在Springboot2.X版本，数据库的连接池官方推荐使用<a href=\"https://github.com/brettwooldridge/HikariCP\" target=\"_blank\" rel=\"noopener\">HikariCP</a>，官方的原话：</p>\n<blockquote>\n<p> Production database connections can also be auto-configured by using a pooling<code>DataSource</code>. Spring Boot uses the following algorithm for choosing a specific implementation:</p>\n<ol>\n<li><p>We prefer<a href=\"https://github.com/brettwooldridge/HikariCP\" target=\"_blank\" rel=\"noopener\">HikariCP</a>for its performance and concurrency. If HikariCP is available, we always choose it.</p>\n</li>\n<li><p>Otherwise, if the Tomcat pooling<code>DataSource</code>is available, we use it.</p>\n</li>\n<li><p>If neither HikariCP nor the Tomcat pooling datasource are available and if<a href=\"https://commons.apache.org/proper/commons-dbcp/\" target=\"_blank\" rel=\"noopener\">Commons DBCP2</a>is available, we use it.</p>\n</li>\n</ol>\n</blockquote>\n<p>意思是说：</p>\n<ol>\n<li><p>我们更喜欢HikariCP的性能和并发性。如果有HikariCP，我们总是选择它</p>\n</li>\n<li><p>否则，如果Tomcat池数据源可用，我们将使用它。</p>\n</li>\n<li><p>如果HikariCP和Tomcat池数据源都不可用，如果Commons DBCP2可用，我们将使用它。</p>\n</li>\n</ol>\n<p>那么如何使用HikariCP呢？</p>\n<p>如果你的springboot版本是2.X，当你使用<code>spring-boot-starter-jdbc</code>或者<code>spring-boot-starter-data-jpa</code>依赖，springboot就会自动引入HikariCP的依赖了。</p>\n<h3 id=\"使用指定的数据库连接池\"><a href=\"#使用指定的数据库连接池\" class=\"headerlink\" title=\"使用指定的数据库连接池\"></a>使用指定的数据库连接池</h3><p>如果你需要使用指定的数据库连接池，那么你需要在<code>application.properties</code>中配置：<code>spring.datasource.type</code></p>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li><p>JDK： 1.8</p>\n</li>\n<li><p>Maven: 3.3.9</p>\n</li>\n<li><p>SpringBoot: 2.0.3.RELEASE</p>\n</li>\n<li><p>开发工具：Intellij IDEA 2017.1.3</p>\n</li>\n</ul>\n<h2 id=\"开始使用\"><a href=\"#开始使用\" class=\"headerlink\" title=\"开始使用\"></a>开始使用</h2><p>本次的配置中我们持久层使用mybatis，使用HikariCP作为数据库连接池。</p>\n<h3 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\">      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">exclusions</span>&gt;</span><br>\t\t<span class=\"hljs-comment\">&lt;!--排除默认的tomcat-jdbc--&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">exclusion</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.apache.tomcat<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>tomcat-jdbc<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">exclusion</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">exclusions</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>mysql<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>5.1.46<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><span class=\"hljs-comment\">&lt;!-- mybatis一定要使用starter，不然无法自动配置和注入 --&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.3.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>以上的依赖就足够了，前面介绍过，只需要导入<code>spring-boot-starter-jdbc</code>依赖springboot就默认使用Hikari作为数据库连接池了。</p>\n<h3 id=\"创建数据表\"><a href=\"#创建数据表\" class=\"headerlink\" title=\"创建数据表\"></a>创建数据表</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">DATABASE</span> mytest;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> t_user(<br>  userId <span class=\"hljs-built_in\">INT</span> <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> PRIMARY <span class=\"hljs-keyword\">KEY</span> AUTO_INCREMENT,<br>  userName <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> ,<br>  <span class=\"hljs-keyword\">password</span> <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> ,<br>  phone <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span><br>) <span class=\"hljs-keyword\">ENGINE</span>=<span class=\"hljs-keyword\">INNODB</span> AUTO_INCREMENT=<span class=\"hljs-number\">1000</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">CHARSET</span>=utf8;<br></code></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"创建实体类\"><a href=\"#创建实体类\" class=\"headerlink\" title=\"创建实体类\"></a>创建实体类</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.model;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/7/25.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserDomain</span> </span>&#123;<br><br>    <span class=\"hljs-keyword\">private</span> Integer userId;<br><br>    <span class=\"hljs-keyword\">private</span> String userName;<br><br>    <span class=\"hljs-keyword\">private</span> String password;<br><br>    <span class=\"hljs-keyword\">private</span> String phone;<br><br>    <span class=\"hljs-comment\">// @TODO 省略get/set</span><br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"创建Dao以及mapper映射\"><a href=\"#创建Dao以及mapper映射\" class=\"headerlink\" title=\"创建Dao以及mapper映射\"></a>创建Dao以及mapper映射</h3><h4 id=\"创建Dao类\"><a href=\"#创建Dao类\" class=\"headerlink\" title=\"创建Dao类\"></a>创建Dao类</h4><p>创建一个dao的包，并且在这个包下创建一个UserDao</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.dao;<br><br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.annotations.Mapper;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.annotations.Param;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/7/25.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Mapper</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">UserDao</span> </span>&#123;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">insert</span><span class=\"hljs-params\">(UserDomain record)</span></span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">deleteUserById</span><span class=\"hljs-params\">(@Param(<span class=\"hljs-string\">\"userId\"</span>)</span> Integer userId)</span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">updateUser</span><span class=\"hljs-params\">(UserDomain userDomain)</span></span>;<br><br>    <span class=\"hljs-function\">List&lt;UserDomain&gt; <span class=\"hljs-title\">selectUsers</span><span class=\"hljs-params\">()</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>注意：一定不要忘了使用<code>@Mapper</code>注解，如果没有这个注解，spring就无法扫描到这个类，导致项目启动报错。</p>\n<h4 id=\"创建Mapper映射\"><a href=\"#创建Mapper映射\" class=\"headerlink\" title=\"创建Mapper映射\"></a>创建Mapper映射</h4><p>上一步我们创建dao数据库持久层类，由于本文使用的是xml映射的方式，所以我们需要创建一个xml映射文件。</p>\n<p>在<code>resources</code>文件夹下新建一个文件夹<code>mapper</code>：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-meta-keyword\">mapper</span> <span class=\"hljs-meta-keyword\">PUBLIC</span> <span class=\"hljs-meta-string\">\"-//mybatis.org//DTD Mapper 3.0//EN\"</span> <span class=\"hljs-meta-string\">\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"</span> &gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">mapper</span> <span class=\"hljs-attr\">namespace</span>=<span class=\"hljs-string\">\"com.winterchen.dao.UserDao\"</span> &gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sql</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>&gt;</span><br>        t_user<br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sql</span>&gt;</span><br><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sql</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"BASE_COLUMN\"</span>&gt;</span><br>        userId,userName,password,phone<br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sql</span>&gt;</span><br><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">insert</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"insert\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"com.winterchen.model.UserDomain\"</span>&gt;</span><br>        INSERT INTO<br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>/&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">trim</span> <span class=\"hljs-attr\">prefix</span>=<span class=\"hljs-string\">\"(\"</span> <span class=\"hljs-attr\">suffix</span>=<span class=\"hljs-string\">\")\"</span> <span class=\"hljs-attr\">suffixOverrides</span>=<span class=\"hljs-string\">\",\"</span>&gt;</span><br>            userName,password,<br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span>&gt;</span><br>                phone,<br>            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">trim</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">trim</span> <span class=\"hljs-attr\">prefix</span>=<span class=\"hljs-string\">\"VALUES(\"</span> <span class=\"hljs-attr\">suffix</span>=<span class=\"hljs-string\">\")\"</span> <span class=\"hljs-attr\">suffixOverrides</span>=<span class=\"hljs-string\">\",\"</span>&gt;</span><br>            #&#123;userName, jdbcType=VARCHAR&#125;,#&#123;password, jdbcType=VARCHAR&#125;,<br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span>&gt;</span><br>                #&#123;phone, jdbcType=VARCHAR&#125;,<br>            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">trim</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">insert</span>&gt;</span><br><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">delete</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"deleteUserById\"</span>&gt;</span><br>      DELETE FROM<br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>/&gt;</span><br>      WHERE<br>      userId = #&#123;userId, jdbcType=INTEGER&#125;<br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">delete</span>&gt;</span><br>    <span class=\"hljs-comment\">&lt;!-- 更新用户信息，为空的字段不进行置空 --&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">update</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"updateUser\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"com.winterchen.model.UserDomain\"</span>&gt;</span><br>        UPDATE<br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>/&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">set</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"userName != null\"</span>&gt;</span><br>              userName = #&#123;userName, jdbcType=VARCHAR&#125;,<br>          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"password != null\"</span>&gt;</span><br>              password = #&#123;password, jdbcType=VARCHAR&#125;,<br>          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>          <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span>&gt;</span><br>              phone = #&#123;phone, jdbcType=VARCHAR&#125;,<br>          <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">set</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">where</span>&gt;</span><br>            userId = #&#123;userId, jdbcType=INTEGER&#125;<br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">where</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">update</span>&gt;</span><br><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">select</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"selectUsers\"</span> <span class=\"hljs-attr\">resultType</span>=<span class=\"hljs-string\">\"com.winterchen.model.UserDomain\"</span>&gt;</span><br>        SELECT<br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_COLUMN\"</span>/&gt;</span><br>        FROM<br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>/&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">select</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p><strong>注意点：</strong> 请将<code>namespace=&quot;com.winterchen.dao.UserDao&quot;</code>改为你自己项目Dao的路径，以及下面方法的一些路径都要改为你自己项目的相关路径。</p>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">server.port&#x3D;8080<br><br>#### 数据库连接池属性<br>spring.datasource.driver-class-name&#x3D;com.mysql.jdbc.Driver<br>spring.datasource.url&#x3D;jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;mytest?useSSL&#x3D;false&amp;useUnicode&#x3D;true&amp;characterEncoding&#x3D;utf-8&amp;allowMultiQueries&#x3D;true<br>spring.datasource.username&#x3D;root<br>spring.datasource.password&#x3D;root<br>#自动提交<br>spring.datasource.default-auto-commit&#x3D;true<br>#指定updates是否自动提交<br>spring.datasource.auto-commit&#x3D;true<br>spring.datasource.maximum-pool-size&#x3D;100<br>spring.datasource.max-idle&#x3D;10<br>spring.datasource.max-wait&#x3D;10000<br>spring.datasource.min-idle&#x3D;5<br>spring.datasource.initial-size&#x3D;5<br>spring.datasource.validation-query&#x3D;SELECT 1<br>spring.datasource.test-on-borrow&#x3D;false<br>spring.datasource.test-while-idle&#x3D;true<br># 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒<br>spring.datasource.time-between-eviction-runs-millis&#x3D;18800<br># 配置一个连接在池中最小生存的时间，单位是毫秒<br>spring.datasource.minEvictableIdleTimeMillis&#x3D;300000<br><br># mybatis对应的映射文件路径<br>mybatis.mapper-locations&#x3D;classpath:mapper&#x2F;*.xml<br># mybatis对应的实体类<br>mybatis.type-aliases-package&#x3D;com.winterchen.model<br></code></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"Service层\"><a href=\"#Service层\" class=\"headerlink\" title=\"Service层\"></a>Service层</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.service;<br><br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/7/25.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">UserService</span> </span>&#123;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">insert</span><span class=\"hljs-params\">(UserDomain record)</span></span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">deleteUserById</span><span class=\"hljs-params\">(Integer userId)</span></span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">updateUser</span><span class=\"hljs-params\">(UserDomain userDomain)</span></span>;<br><br>    <span class=\"hljs-function\">List&lt;UserDomain&gt; <span class=\"hljs-title\">selectUsers</span><span class=\"hljs-params\">()</span></span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"Service-实现层\"><a href=\"#Service-实现层\" class=\"headerlink\" title=\"Service 实现层\"></a>Service 实现层</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.service.impl;<br><br><span class=\"hljs-keyword\">import</span> com.winterchen.dao.UserDao;<br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><span class=\"hljs-keyword\">import</span> com.winterchen.service.UserService;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.stereotype.Service;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/7/25.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Service</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserServiceImpl</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">UserService</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> UserDao userDao;<span class=\"hljs-comment\">//这里会爆红，请忽略</span><br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">insert</span><span class=\"hljs-params\">(UserDomain record)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> userDao.insert(record);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">deleteUserById</span><span class=\"hljs-params\">(Integer userId)</span> </span>&#123;<br>        userDao.deleteUserById(userId);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">updateUser</span><span class=\"hljs-params\">(UserDomain userDomain)</span> </span>&#123;<br>        userDao.updateUser(userDomain);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> List&lt;UserDomain&gt; <span class=\"hljs-title\">selectUsers</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> userDao.selectUsers();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"Controller层\"><a href=\"#Controller层\" class=\"headerlink\" title=\"Controller层\"></a>Controller层</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.controller;<br><br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><span class=\"hljs-keyword\">import</span> com.winterchen.service.UserService;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.http.ResponseEntity;<br><span class=\"hljs-keyword\">import</span> org.springframework.web.bind.annotation.*;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/7/25.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@RestController</span><br><span class=\"hljs-meta\">@RequestMapping</span>(<span class=\"hljs-string\">\"/user\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserController</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> UserService userService;<br><br>    <span class=\"hljs-meta\">@PostMapping</span>(<span class=\"hljs-string\">\"\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> ResponseEntity <span class=\"hljs-title\">addUser</span><span class=\"hljs-params\">(</span></span><br><span class=\"hljs-function\"><span class=\"hljs-params\">            @RequestParam(value = <span class=\"hljs-string\">\"userName\"</span>, required = <span class=\"hljs-keyword\">true</span>)</span></span><br><span class=\"hljs-function\">            String userName,</span><br><span class=\"hljs-function\">            @<span class=\"hljs-title\">RequestParam</span><span class=\"hljs-params\">(value = <span class=\"hljs-string\">\"password\"</span>, required = <span class=\"hljs-keyword\">true</span>)</span></span><br><span class=\"hljs-function\">            String password,</span><br><span class=\"hljs-function\">            @<span class=\"hljs-title\">RequestParam</span><span class=\"hljs-params\">(value = <span class=\"hljs-string\">\"phone\"</span>, required = <span class=\"hljs-keyword\">false</span>)</span></span><br><span class=\"hljs-function\">            String phone</span><br><span class=\"hljs-function\">    )</span>&#123;<br>        UserDomain userDomain = <span class=\"hljs-keyword\">new</span> UserDomain();<br>        userDomain.setUserName(userName);<br>        userDomain.setPassword(password);<br>        userDomain.setPhone(phone);<br>        userService.insert(userDomain);<br>        <span class=\"hljs-keyword\">return</span> ResponseEntity.ok(<span class=\"hljs-string\">\"添加成功\"</span>);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@DeleteMapping</span>(<span class=\"hljs-string\">\"\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> ResponseEntity <span class=\"hljs-title\">deleteUser</span><span class=\"hljs-params\">(@RequestParam(value = <span class=\"hljs-string\">\"userId\"</span>, required = <span class=\"hljs-keyword\">true</span>)</span> Integer userId)</span>&#123;<br><br>        userService.deleteUserById(userId);<br>        <span class=\"hljs-keyword\">return</span> ResponseEntity.ok(<span class=\"hljs-string\">\"删除成功\"</span>);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@PutMapping</span>(<span class=\"hljs-string\">\"\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> ResponseEntity <span class=\"hljs-title\">updateUser</span><span class=\"hljs-params\">(</span></span><br><span class=\"hljs-function\"><span class=\"hljs-params\">            @RequestParam(value = <span class=\"hljs-string\">\"userId\"</span>, required = <span class=\"hljs-keyword\">true</span>)</span></span><br><span class=\"hljs-function\">                    Integer userId,</span><br><span class=\"hljs-function\">            @<span class=\"hljs-title\">RequestParam</span><span class=\"hljs-params\">(value = <span class=\"hljs-string\">\"userName\"</span>, required = <span class=\"hljs-keyword\">false</span>)</span></span><br><span class=\"hljs-function\">                    String userName,</span><br><span class=\"hljs-function\">            @<span class=\"hljs-title\">RequestParam</span><span class=\"hljs-params\">(value = <span class=\"hljs-string\">\"password\"</span>, required = <span class=\"hljs-keyword\">false</span>)</span></span><br><span class=\"hljs-function\">                    String password,</span><br><span class=\"hljs-function\">            @<span class=\"hljs-title\">RequestParam</span><span class=\"hljs-params\">(value = <span class=\"hljs-string\">\"phone\"</span>, required = <span class=\"hljs-keyword\">false</span>)</span></span><br><span class=\"hljs-function\">                    String phone</span><br><span class=\"hljs-function\">    )</span>&#123;<br>        UserDomain userDomain = <span class=\"hljs-keyword\">new</span> UserDomain();<br>        userDomain.setUserId(userId);<br>        userDomain.setUserName(userName);<br>        userDomain.setPassword(password);<br>        userDomain.setPhone(phone);<br>        userService.updateUser(userDomain);<br>        <span class=\"hljs-keyword\">return</span> ResponseEntity.ok(<span class=\"hljs-string\">\"更新成功\"</span>);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@GetMapping</span>(<span class=\"hljs-string\">\"\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> ResponseEntity <span class=\"hljs-title\">getUsers</span><span class=\"hljs-params\">()</span></span>&#123;<br>        <span class=\"hljs-keyword\">return</span> ResponseEntity.ok(userService.selectUsers());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>强行科普一下：</p>\n<ul>\n<li><p><code>@RequestParam</code> 用于将请求参数区数据映射到功能处理方法的参数上，<code>value</code>：参数名字，即入参的请求参数名字，如userName表示请求的参数区中的名字为userName的参数的值将传入，<code>required</code>：是否必须，默认是true，表示请求中一定要有相应的参数，否则将报404错误码；</p>\n</li>\n<li><p><a href=\"https://www.cnblogs.com/shuaifing/p/8119664.html\" target=\"_blank\" rel=\"noopener\">@Controller和@RestController的区别？</a></p>\n</li>\n</ul>\n<h3 id=\"启动类\"><a href=\"#启动类\" class=\"headerlink\" title=\"启动类\"></a>启动类</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen;<br><br><span class=\"hljs-keyword\">import</span> org.springframework.boot.SpringApplication;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class=\"hljs-meta\">@SpringBootApplication</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">SpringBootMybatisHikaricpApplication</span> </span>&#123;<br><br>\t<span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span> </span>&#123;<br>\t\tSpringApplication.run(SpringBootMybatisHikaricpApplication<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>, <span class=\"hljs-title\">args</span>)</span>;<br>\t&#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"最终项目结构\"><a href=\"#最终项目结构\" class=\"headerlink\" title=\"最终项目结构\"></a>最终项目结构</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463452426.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">目录结构</span></p>\n<h2 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h2><p>启动项目启动类</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">2018-07-25 15:25:42.970  INFO 22602 --- [           main] o.s.w.s.handler.SimpleUrlHandlerMapping  : Mapped URL path [&#x2F;**] onto handler of type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]<br>2018-07-25 15:25:43.380  INFO 22602 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Registering beans for JMX exposure on startup<br>2018-07-25 15:25:43.382  INFO 22602 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Bean with name &#39;dataSource&#39; has been autodetected for JMX exposure<br>2018-07-25 15:25:43.389  INFO 22602 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Located MBean &#39;dataSource&#39;: registering with JMX server as MBean [com.zaxxer.hikari:name&#x3D;dataSource,type&#x3D;HikariDataSource]<br>2018-07-25 15:25:43.450  INFO 22602 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path &#39;&#39;<br>2018-07-25 15:25:43.456  INFO 22602 --- [           main] c.w.SpringBootMybatisHikaricpApplication : Started SpringBootMybatisHikaricpApplication in 6.267 seconds (JVM running for 7.784)<br></code></pre></td></tr></table></figure>\n\n<p>这样的输出表示项目启动成功了！！如果遇到报错启动不了，请回头看看是不是有些地方没有注意到。</p>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>项目成功启动了，那么可以开始测试了</p>\n<p>推荐使用一个强大的http请求工具：Postman</p>\n<h3 id=\"添加\"><a href=\"#添加\" class=\"headerlink\" title=\"添加\"></a>添加</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463496426.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">添加</span></p>\n<h3 id=\"删除\"><a href=\"#删除\" class=\"headerlink\" title=\"删除\"></a>删除</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463538427.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">删除</span></p>\n<h3 id=\"更新\"><a href=\"#更新\" class=\"headerlink\" title=\"更新\"></a>更新</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463575426.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">更新</span></p>\n<h3 id=\"查找\"><a href=\"#查找\" class=\"headerlink\" title=\"查找\"></a>查找</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463616426.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">查找</span></p>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><blockquote>\n<p> 在编程的路上肯定会遇到很多的bug，程序员就是要不断的和bug作斗争，加油，愿你成为真正的大牛。有机会讲讲Hikari如何使用多数据源。</p>\n</blockquote>\n<p>源码地址：<a href=\"https://github.com/WinterChenS/springboot-learning-experience/tree/master/spring-boot-mybatis-hikaricp\" target=\"_blank\" rel=\"noopener\">戳这里</a></p>\n<p>springboot技术交流群：681513531</p>\n<p>个人博客：<a href=\"https://winterchen.com/\" target=\"_blank\" rel=\"noopener\">https://winterchen.com</a></p>\n","raw":null,"categories":[{"name":"Spring Boot","path":"api/categories/Spring Boot.json"}],"tags":[{"name":"Spring Boot","path":"api/tags/Spring Boot.json"},{"name":"mybatis","path":"api/tags/mybatis.json"},{"name":"HikariCP","path":"api/tags/HikariCP.json"}]},{"title":"springboot2.0 mybatis 使用多数据源","slug":"spring-boot-mybatis-mutil-database","date":"2018-05-30T10:39:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/spring-boot-mybatis-mutil-database.json","excerpt":" [Figure] springboot2.0正式版发布之后，很多的组件集成需要变更了，这次将多数据源的使用踩的坑给大家填一填。当前多数据源的主要为主从库，读写分离，动态切换数据源。使用的技术就是AOP进行dao方法的切面，所以大家的方法名开头都需要按照规范进行编写，如：get***、add*** 等等，","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://images.unsplash.com/photo-1496737018672-b1a6be2e949c?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=f0aa3d84be0ad9a656a27a318f055ee9&auto=format&fit=crop&w=2691&q=80","content":"<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463697426.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">多数据源</span><br>springboot2.0正式版发布之后，很多的组件集成需要变更了，这次将多数据源的使用踩的坑给大家填一填。当前多数据源的主要为主从库，读写分离，动态切换数据源。使用的技术就是AOP进行dao方法的切面，所以大家的方法名开头都需要按照规范进行编写，如：<code>get***</code>、<code>add***</code> 等等，</p>\n<a id=\"more\"></a>\n<h2 id=\"起步基础\"><a href=\"#起步基础\" class=\"headerlink\" title=\"起步基础\"></a>起步基础</h2><p>本次的教程需要有springboot2.0集成mybatis 作为基础：</p>\n<ul>\n<li><p>博客地址：<a href=\"https://blog.csdn.net/Winter_chen001/article/details/80010967\" target=\"_blank\" rel=\"noopener\">springboot2.0 Mybatis 整合 (springboot2.0版本)</a></p>\n</li>\n<li><p>基础项目源码：<a href=\"https://github.com/WinterChenS/springboot2-mybatis-demo\" target=\"_blank\" rel=\"noopener\">https://github.com/WinterChenS/springboot2-mybatis-demo</a></p>\n</li>\n</ul>\n<p>需要以上的步骤作为基础，运行成功之后可就可以开始配置多数据源了</p>\n<h2 id=\"开始动手\"><a href=\"#开始动手\" class=\"headerlink\" title=\"开始动手\"></a>开始动手</h2><h3 id=\"添加依赖\"><a href=\"#添加依赖\" class=\"headerlink\" title=\"添加依赖\"></a>添加依赖</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">&lt;dependency&gt;<br>  &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;<br>  &lt;artifactId&gt;spring-boot-starter-aop&lt;&#x2F;artifactId&gt;<br>&lt;&#x2F;dependency&gt;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"修改启动类\"><a href=\"#修改启动类\" class=\"headerlink\" title=\"修改启动类\"></a>修改启动类</h3><p>修改之前：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@SpringBootApplication</span><br><span class=\"hljs-meta\">@MapperScan</span>(<span class=\"hljs-string\">\"com.winterchen.dao\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">SpringBootMybatisMutilDatabaseApplication</span> </span>&#123;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(SpringBootMybatisMutilDatabaseApplication<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>, <span class=\"hljs-title\">args</span>)</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>修改之后：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@SpringBootApplication</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">SpringBootMybatisMutilDatabaseApplication</span> </span>&#123;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span> </span>&#123;<br>        SpringApplication.run(SpringBootMybatisMutilDatabaseApplication<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>, <span class=\"hljs-title\">args</span>)</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>因为改用多数据源，所以dao接口的扫描我们放在配置类中进行</p>\n<h3 id=\"修改项目配置\"><a href=\"#修改项目配置\" class=\"headerlink\" title=\"修改项目配置\"></a>修改项目配置</h3><p>首先我们需要在配置文件中配置多数据源，看一下原本项目的配置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">spring:</span><br>    <span class=\"hljs-attr\">datasource:</span><br>        <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">mysql_test</span><br>        <span class=\"hljs-comment\">#-----------------start-----------------#  （1）</span><br>        <span class=\"hljs-attr\">type:</span> <span class=\"hljs-string\">com.alibaba.druid.pool.DruidDataSource</span><br>        <span class=\"hljs-comment\">#-----------------end-----------------#</span><br>        <span class=\"hljs-comment\">#druid相关配置</span><br>        <span class=\"hljs-attr\">druid:</span><br>          <span class=\"hljs-comment\">#监控统计拦截的filters</span><br>          <span class=\"hljs-attr\">filters:</span> <span class=\"hljs-string\">stat</span><br>          <span class=\"hljs-comment\">#-----------------start-----------------# （2）</span><br>          <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span><br>          <span class=\"hljs-comment\">#基本属性</span><br>          <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/mytest?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</span><br>          <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span><br>          <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span><br>           <span class=\"hljs-comment\">#-----------------end-----------------#</span><br>          <span class=\"hljs-comment\">#配置初始化大小/最小/最大</span><br>          <span class=\"hljs-attr\">initial-size:</span> <span class=\"hljs-number\">1</span><br>          <span class=\"hljs-attr\">min-idle:</span> <span class=\"hljs-number\">1</span><br>          <span class=\"hljs-attr\">max-active:</span> <span class=\"hljs-number\">20</span><br>          <span class=\"hljs-comment\">#获取连接等待超时时间</span><br>          <span class=\"hljs-attr\">max-wait:</span> <span class=\"hljs-number\">60000</span><br>          <span class=\"hljs-comment\">#间隔多久进行一次检测，检测需要关闭的空闲连接</span><br>          <span class=\"hljs-attr\">time-between-eviction-runs-millis:</span> <span class=\"hljs-number\">60000</span><br>          <span class=\"hljs-comment\">#一个连接在池中最小生存的时间</span><br>          <span class=\"hljs-attr\">min-evictable-idle-time-millis:</span> <span class=\"hljs-number\">300000</span><br>          <span class=\"hljs-attr\">validation-query:</span> <span class=\"hljs-string\">SELECT</span> <span class=\"hljs-string\">'x'</span><br>          <span class=\"hljs-attr\">test-while-idle:</span> <span class=\"hljs-literal\">true</span><br>          <span class=\"hljs-attr\">test-on-borrow:</span> <span class=\"hljs-literal\">false</span><br>          <span class=\"hljs-attr\">test-on-return:</span> <span class=\"hljs-literal\">false</span><br>          <span class=\"hljs-comment\">#打开PSCache，并指定每个连接上PSCache的大小。oracle设为true，mysql设为false。分库分表较多推荐设置为false</span><br>          <span class=\"hljs-attr\">pool-prepared-statements:</span> <span class=\"hljs-literal\">false</span><br>          <span class=\"hljs-attr\">max-pool-prepared-statement-per-connection-size:</span> <span class=\"hljs-number\">20</span><br></code></pre></td></tr></table></figure>\n\n<p>*<em>需要修改的地方: *</em></p>\n<ul>\n<li><p>(1) 需要将 <code>type: com.alibaba.druid.pool.DruidDataSource</code>去除；</p>\n</li>\n<li><p>(2) 将关于数据库的连接信息: <code>driver-class-name</code>、<code>url</code>、<code>username</code> 、<code>password</code>  去除；</p>\n</li>\n</ul>\n<p><strong>修改后：</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">spring:</span><br>    <span class=\"hljs-attr\">datasource:</span><br>        <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">mysql_test</span><br>        <span class=\"hljs-comment\">#-------------- start ----------------# (1)</span><br>        <span class=\"hljs-attr\">master:</span><br>          <span class=\"hljs-comment\">#基本属性--注意，这里的为【jdbcurl】-- 默认使用HikariPool作为数据库连接池</span><br>          <span class=\"hljs-attr\">jdbcurl:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/mytest?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</span><br>          <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span><br>          <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span><br>          <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span><br>        <span class=\"hljs-attr\">slave:</span><br>          <span class=\"hljs-comment\">#基本属性--注意，这里为 【url】-- 使用 druid 作为数据库连接池</span><br>          <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/mytest?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</span><br>          <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span><br>          <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span><br>          <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span><br>        <span class=\"hljs-attr\">read:</span> <span class=\"hljs-string\">get,select,count,list,query,find</span><br>        <span class=\"hljs-attr\">write:</span> <span class=\"hljs-string\">add,create,update,delete,remove,insert</span><br>        <span class=\"hljs-comment\">#-------------- end ----------------#</span><br>        <span class=\"hljs-comment\">#druid相关配置</span><br>        <span class=\"hljs-attr\">druid:</span><br>          <span class=\"hljs-comment\">#监控统计拦截的filters</span><br>          <span class=\"hljs-attr\">filters:</span> <span class=\"hljs-string\">stat,wall</span><br>          <span class=\"hljs-comment\">#配置初始化大小/最小/最大</span><br>          <span class=\"hljs-attr\">initial-size:</span> <span class=\"hljs-number\">1</span><br>          <span class=\"hljs-attr\">min-idle:</span> <span class=\"hljs-number\">1</span><br>          <span class=\"hljs-attr\">max-active:</span> <span class=\"hljs-number\">20</span><br>          <span class=\"hljs-comment\">#获取连接等待超时时间</span><br>          <span class=\"hljs-attr\">max-wait:</span> <span class=\"hljs-number\">60000</span><br>          <span class=\"hljs-comment\">#间隔多久进行一次检测，检测需要关闭的空闲连接</span><br>          <span class=\"hljs-attr\">time-between-eviction-runs-millis:</span> <span class=\"hljs-number\">60000</span><br>          <span class=\"hljs-comment\">#一个连接在池中最小生存的时间</span><br>          <span class=\"hljs-attr\">min-evictable-idle-time-millis:</span> <span class=\"hljs-number\">300000</span><br>          <span class=\"hljs-attr\">validation-query:</span> <span class=\"hljs-string\">SELECT</span> <span class=\"hljs-string\">'x'</span><br>          <span class=\"hljs-attr\">test-while-idle:</span> <span class=\"hljs-literal\">true</span><br>          <span class=\"hljs-attr\">test-on-borrow:</span> <span class=\"hljs-literal\">false</span><br>          <span class=\"hljs-attr\">test-on-return:</span> <span class=\"hljs-literal\">false</span><br>          <span class=\"hljs-comment\">#打开PSCache，并指定每个连接上PSCache的大小。oracle设为true，mysql设为false。分库分表较多推荐设置为false</span><br>          <span class=\"hljs-attr\">pool-prepared-statements:</span> <span class=\"hljs-literal\">false</span><br>          <span class=\"hljs-attr\">max-pool-prepared-statement-per-connection-size:</span> <span class=\"hljs-number\">20</span><br></code></pre></td></tr></table></figure>\n\n<p>需要修改地方：</p>\n<ul>\n<li>(1) 在如上的配置中添加<code>master</code>、<code>slave</code>两个数据源;</li>\n</ul>\n<p><strong>注意！！</strong>两中数据源中有一处是不一样的，原因是因为<code>master</code>数据源使用 <code>Hikari</code>连接池，<code>slave</code>使用的是<code>druid</code>作为数据库连接池，所以两处的配置分别为：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">master:</span><br>    <span class=\"hljs-attr\">jdbcurl:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/mytest?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</span><br></code></pre></td></tr></table></figure>\n\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">slave:</span><br>    <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/mytest?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</span><br></code></pre></td></tr></table></figure>\n\n<p>数据库的连接不一样的，如果配置成一样的会在启动的时候报错。</p>\n<p><strong>注意！！</strong></p>\n<p>dao接口方法的方法名规则配置在这里了，当然可以自行更改：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">read:</span> <span class=\"hljs-string\">get,select,count,list,query,find</span><br><span class=\"hljs-attr\">write:</span> <span class=\"hljs-string\">add,create,update,delete,remove,insert</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"创建配置包\"><a href=\"#创建配置包\" class=\"headerlink\" title=\"创建配置包\"></a>创建配置包</h3><p>首先在项目的<code>/src/main/java/com/winterchen/</code>包下创建<code>config</code>包</p>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463787428.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">创建config包</span></p>\n<h3 id=\"创建数据源类型的枚举DatabaseType\"><a href=\"#创建数据源类型的枚举DatabaseType\" class=\"headerlink\" title=\"创建数据源类型的枚举DatabaseType\"></a>创建数据源类型的枚举DatabaseType</h3><p>该枚举类主要用来区分读写</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.config;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 列出数据源类型</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/5/29.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">enum</span> DatabaseType &#123;<br><br>    master(<span class=\"hljs-string\">\"write\"</span>), slave(<span class=\"hljs-string\">\"read\"</span>);<br><br><br>    DatabaseType(String name) &#123;<br>        <span class=\"hljs-keyword\">this</span>.name = name;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">private</span> String name;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title\">getName</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> name;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setName</span><span class=\"hljs-params\">(String name)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.name = name;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title\">toString</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">\"DatabaseType&#123;\"</span> +<br>                <span class=\"hljs-string\">\"name='\"</span> + name + <span class=\"hljs-string\">'\\''</span> +<br>                <span class=\"hljs-string\">'&#125;'</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"创建线程安全的DatabaseType容器\"><a href=\"#创建线程安全的DatabaseType容器\" class=\"headerlink\" title=\"创建线程安全的DatabaseType容器\"></a>创建线程安全的DatabaseType容器</h3><p>多数据源必须要保证数据源的线程安全的</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.config;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 保存一个线程安全的DatabaseType容器</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/5/29.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DatabaseContextHolder</span> </span>&#123;<br><br>        <span class=\"hljs-comment\">//用于存放多线程环境下的成员变量</span><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> ThreadLocal&lt;DatabaseType&gt; contextHolder = <span class=\"hljs-keyword\">new</span> ThreadLocal&lt;&gt;();<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setDatabaseType</span><span class=\"hljs-params\">(DatabaseType type)</span> </span>&#123;<br>        contextHolder.set(type);<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> DatabaseType <span class=\"hljs-title\">getDatabaseType</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> contextHolder.get();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"创建动态数据源\"><a href=\"#创建动态数据源\" class=\"headerlink\" title=\"创建动态数据源\"></a>创建动态数据源</h3><p>实现数据源切换的功能就是自定义一个类扩展AbstractRoutingDataSource抽象类，其实该相当于数据源DataSource的路由中介，可以实现在项目运行时根据相应key值切换到对应的数据源DataSource上，有兴趣的同学可以看看它的源码。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DynamicDataSource</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">AbstractRoutingDataSource</span> </span>&#123;<br><br>    <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> Map&lt;DatabaseType, List&lt;String&gt;&gt; METHOD_TYPE_MAP = <span class=\"hljs-keyword\">new</span> HashMap&lt;&gt;();<br><br><br>    <span class=\"hljs-meta\">@Nullable</span><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">protected</span> Object <span class=\"hljs-title\">determineCurrentLookupKey</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        DatabaseType type = DatabaseContextHolder.getDatabaseType();<br>        logger.info(<span class=\"hljs-string\">\"====================dataSource ==========\"</span> + type);<br>        <span class=\"hljs-keyword\">return</span> type;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setMethodType</span><span class=\"hljs-params\">(DatabaseType type, String content)</span> </span>&#123;<br>        List&lt;String&gt; list = Arrays.asList(content.split(<span class=\"hljs-string\">\",\"</span>));<br>        METHOD_TYPE_MAP.put(type, list);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"创建数据源配置类DataSourceConfig\"><a href=\"#创建数据源配置类DataSourceConfig\" class=\"headerlink\" title=\"创建数据源配置类DataSourceConfig\"></a>创建数据源配置类DataSourceConfig</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-meta\">@MapperScan</span>(<span class=\"hljs-string\">\"com.winterchen.dao\"</span>)<br><span class=\"hljs-meta\">@EnableTransactionManagement</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DataSourceConfig</span> </span>&#123;<br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> Logger logger = LoggerFactory.getLogger(DataSourceConfig<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> Environment env;  <span class=\"hljs-comment\">// (1)</span><br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> DataSourceProperties properties;  <span class=\"hljs-comment\">// (2)</span><br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.filters&#125;\"</span>)   <span class=\"hljs-comment\">// (3)</span><br>    <span class=\"hljs-keyword\">private</span> String filters;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.initial-size&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Integer initialSize;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.min-idle&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Integer minIdle;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.max-active&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Integer maxActive;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.max-wait&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Integer maxWait;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.time-between-eviction-runs-millis&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Long timeBetweenEvictionRunsMillis;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.min-evictable-idle-time-millis&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Long minEvictableIdleTimeMillis;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.validation-query&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String validationQuery;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.test-while-idle&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Boolean testWhileIdle;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.test-on-borrow&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">boolean</span> testOnBorrow;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.test-on-return&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">boolean</span> testOnReturn;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.pool-prepared-statements&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">boolean</span> poolPreparedStatements;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.druid.max-pool-prepared-statement-per-connection-size&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> Integer maxPoolPreparedStatementPerConnectionSize;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 通过Spring JDBC 快速创建 DataSource</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span></span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@Bean</span>(name = <span class=\"hljs-string\">\"masterDataSource\"</span>)<br>    <span class=\"hljs-meta\">@Qualifier</span>(<span class=\"hljs-string\">\"masterDataSource\"</span>)<br>    <span class=\"hljs-meta\">@ConfigurationProperties</span>(prefix = <span class=\"hljs-string\">\"spring.datasource.master\"</span>)  <span class=\"hljs-comment\">// (4)</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> DataSource <span class=\"hljs-title\">masterDataSource</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> DataSourceBuilder.create().build();<br>    &#125;<br><br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 手动创建DruidDataSource,通过DataSourceProperties 读取配置</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span></span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@throws</span> SQLException</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@Bean</span>(name = <span class=\"hljs-string\">\"slaveDataSource\"</span>)<br>    <span class=\"hljs-meta\">@Qualifier</span>(<span class=\"hljs-string\">\"slaveDataSource\"</span>)<br>    <span class=\"hljs-meta\">@ConfigurationProperties</span>(prefix = <span class=\"hljs-string\">\"spring.datasource.slave\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> DataSource <span class=\"hljs-title\">slaveDataSource</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> SQLException </span>&#123;<br>        DruidDataSource dataSource = <span class=\"hljs-keyword\">new</span> DruidDataSource();<br>        dataSource.setFilters(filters);<br>        dataSource.setUrl(properties.getUrl());<br>        dataSource.setDriverClassName(properties.getDriverClassName());<br>        dataSource.setUsername(properties.getUsername());<br>        dataSource.setPassword(properties.getPassword());<br>        dataSource.setInitialSize(initialSize);<br>        dataSource.setMinIdle(minIdle);<br>        dataSource.setMaxActive(maxActive);<br>        dataSource.setMaxWait(maxWait);<br>        dataSource.setTimeBetweenEvictionRunsMillis(timeBetweenEvictionRunsMillis);<br>        dataSource.setMinEvictableIdleTimeMillis(minEvictableIdleTimeMillis);<br>        dataSource.setValidationQuery(validationQuery);<br>        dataSource.setTestWhileIdle(testWhileIdle);<br>        dataSource.setTestOnBorrow(testOnBorrow);<br>        dataSource.setTestOnReturn(testOnReturn);<br>        dataSource.setPoolPreparedStatements(poolPreparedStatements);<br>        dataSource.setMaxPoolPreparedStatementPerConnectionSize(maxPoolPreparedStatementPerConnectionSize);<br>        <span class=\"hljs-keyword\">return</span> dataSource;<br>    &#125;<br><br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     *  构造多数据源连接池</span><br><span class=\"hljs-comment\">     *  Master 数据源连接池采用 HikariDataSource</span><br><span class=\"hljs-comment\">     *  Slave  数据源连接池采用 DruidDataSource</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> master</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> slave</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span></span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-meta\">@Primary</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> DynamicDataSource <span class=\"hljs-title\">dataSource</span><span class=\"hljs-params\">(@Qualifier(<span class=\"hljs-string\">\"masterDataSource\"</span>)</span> DataSource master,</span><br><span class=\"hljs-function\">                                        @<span class=\"hljs-title\">Qualifier</span><span class=\"hljs-params\">(<span class=\"hljs-string\">\"slaveDataSource\"</span>)</span> DataSource slave) </span>&#123;<br>        Map&lt;Object, Object&gt; targetDataSources = <span class=\"hljs-keyword\">new</span> HashMap&lt;&gt;();<br>        targetDataSources.put(DatabaseType.master, master);<br>        targetDataSources.put(DatabaseType.slave, slave);<br><br>        DynamicDataSource dataSource = <span class=\"hljs-keyword\">new</span> DynamicDataSource();<br>        dataSource.setTargetDataSources(targetDataSources);<span class=\"hljs-comment\">// 该方法是AbstractRoutingDataSource的方法</span><br>        dataSource.setDefaultTargetDataSource(slave);<span class=\"hljs-comment\">// 默认的datasource设置为myTestDbDataSource</span><br><br>        String read = env.getProperty(<span class=\"hljs-string\">\"spring.datasource.read\"</span>);<br>        dataSource.setMethodType(DatabaseType.slave, read);<br><br>        String write = env.getProperty(<span class=\"hljs-string\">\"spring.datasource.write\"</span>);<br>        dataSource.setMethodType(DatabaseType.master, write);<br><br>        <span class=\"hljs-keyword\">return</span> dataSource;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> SqlSessionFactory <span class=\"hljs-title\">sqlSessionFactory</span><span class=\"hljs-params\">(@Qualifier(<span class=\"hljs-string\">\"masterDataSource\"</span>)</span> DataSource myTestDbDataSource,</span><br><span class=\"hljs-function\">                                               @<span class=\"hljs-title\">Qualifier</span><span class=\"hljs-params\">(<span class=\"hljs-string\">\"slaveDataSource\"</span>)</span> DataSource myTestDb2DataSource) <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>        SqlSessionFactoryBean fb = <span class=\"hljs-keyword\">new</span> SqlSessionFactoryBean();<br>        fb.setDataSource(<span class=\"hljs-keyword\">this</span>.dataSource(myTestDbDataSource, myTestDb2DataSource));<br>        fb.setTypeAliasesPackage(env.getProperty(<span class=\"hljs-string\">\"mybatis.type-aliases-package\"</span>));<br>        fb.setMapperLocations(<span class=\"hljs-keyword\">new</span> PathMatchingResourcePatternResolver().getResources(env.getProperty(<span class=\"hljs-string\">\"mybatis.mapper-locations\"</span>)));<br>        <span class=\"hljs-keyword\">return</span> fb.getObject();<br>    &#125;<br><br><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> DataSourceTransactionManager <span class=\"hljs-title\">transactionManager</span><span class=\"hljs-params\">(DynamicDataSource dataSource)</span> <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> DataSourceTransactionManager(dataSource);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>以上的代码中：</p>\n<ul>\n<li><p>(1)  注入类 <code>Environment</code> 可以很方便的获取配置文件中的参数</p>\n</li>\n<li><p>(2)  <code>DataSourceProperties</code>和（4）中的 <code>@ConfigurationProperties(prefix = &quot;spring.datasource.master&quot;)</code>配合使用，将配置文件中的配置数据自动封装到实体类<code>DataSourceProperties</code>中</p>\n</li>\n<li><p>(3) <code>@Value</code>注解同样是指定获取配置文件中的配置;</p>\n</li>\n</ul>\n<p>更详细的配置大家可以参考官方文档。</p>\n<h3 id=\"配置AOP\"><a href=\"#配置AOP\" class=\"headerlink\" title=\"配置AOP\"></a>配置AOP</h3><p>本章的开头已经说过，多数据源动态切换的原理是利用AOP切面进行动态的切换的，当调用<code>dao</code>接口方法时，根据接口方法的方法名开头进行区分读写。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * 动态处理数据源，根据命名区分</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/5/29.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Aspect</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@EnableAspectJAutoProxy</span>(proxyTargetClass = <span class=\"hljs-keyword\">true</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DataSourceAspect</span> </span>&#123;<br><br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> Logger logger = LoggerFactory.getLogger(DataSourceAspect<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;<br><br>    <span class=\"hljs-meta\">@Pointcut</span>(<span class=\"hljs-string\">\"execution(* com.winterchen.dao.*.*(..))\"</span>)<span class=\"hljs-comment\">//切点</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">aspect</span><span class=\"hljs-params\">()</span> </span>&#123;<br><br>    &#125;<br><br><br>    <span class=\"hljs-meta\">@Before</span>(<span class=\"hljs-string\">\"aspect()\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">before</span><span class=\"hljs-params\">(JoinPoint point)</span> </span>&#123; <span class=\"hljs-comment\">//在指定切点的方法之前执行</span><br>        String className = point.getTarget().getClass().getName();<br>        String method = point.getSignature().getName();<br>        String args = StringUtils.join(point.getArgs(), <span class=\"hljs-string\">\",\"</span>);<br>        logger.info(<span class=\"hljs-string\">\"className:&#123;&#125;, method:&#123;&#125;, args:&#123;&#125; \"</span>, className, method, args);<br>        <span class=\"hljs-keyword\">try</span> &#123;<br>            <span class=\"hljs-keyword\">for</span> (DatabaseType type : DatabaseType.values()) &#123;<br>                List&lt;String&gt; values = DynamicDataSource.METHOD_TYPE_MAP.get(type);<br>                <span class=\"hljs-keyword\">for</span> (String key : values) &#123;<br>                    <span class=\"hljs-keyword\">if</span> (method.startsWith(key)) &#123;<br>                        logger.info(<span class=\"hljs-string\">\"&gt;&gt;&#123;&#125; 方法使用的数据源为:&#123;&#125;&lt;&lt;\"</span>, method, key);<br>                        DatabaseContextHolder.setDatabaseType(type);<br>                        DatabaseType types = DatabaseContextHolder.getDatabaseType();<br>                        logger.info(<span class=\"hljs-string\">\"&gt;&gt;&#123;&#125;方法使用的数据源为:&#123;&#125;&lt;&lt;\"</span>, method, types);<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125; <span class=\"hljs-keyword\">catch</span> (Exception e) &#123;<br>            logger.error(e.getMessage(), e);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>如上可以看到，切点切在<code>dao</code>的接口方法中，根据接口方法的方法名进行匹配数据源，然后将数据源set到用于存放数据源线程安全的容器中；</p>\n<p>完整的项目结构了解一下：</p>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046463912428.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">完整项目结构</span></p>\n<h2 id=\"项目启动\"><a href=\"#项目启动\" class=\"headerlink\" title=\"项目启动\"></a>项目启动</h2><p>启动成功：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">2018-05-30 17:27:16.492  INFO 35406 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Located MBean &#39;masterDataSource&#39;: registering with JMX server as MBean [com.zaxxer.hikari:name&#x3D;masterDataSource,type&#x3D;HikariDataSource]<br>2018-05-30 17:27:16.496  INFO 35406 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Located MBean &#39;slaveDataSource&#39;: registering with JMX server as MBean [com.alibaba.druid.pool:name&#x3D;slaveDataSource,type&#x3D;DruidDataSource]<br>2018-05-30 17:27:16.498  INFO 35406 --- [           main] o.s.j.e.a.AnnotationMBeanExporter        : Located MBean &#39;statFilter&#39;: registering with JMX server as MBean [com.alibaba.druid.filter.stat:name&#x3D;statFilter,type&#x3D;StatFilter]<br>2018-05-30 17:27:16.590  INFO 35406 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path &#39;&#39;<br>2018-05-30 17:27:16.598  INFO 35406 --- [           main] pringBootMybatisMutilDatabaseApplication : Started SpringBootMybatisMutilDatabaseApplication in 11.523 seconds (JVM running for 13.406)<br></code></pre></td></tr></table></figure>\n\n<p>添加用户（write）：</p>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464083964.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">添加用户</span></p>\n<p>日志：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">2018-05-30 17:29:07.347  INFO 35406 --- [nio-8080-exec-1] com.winterchen.config.DataSourceAspect   : className:com.sun.proxy.$Proxy73, method:insert, args:com.winterchen.model.UserDomain@4b5b52dc<br>2018-05-30 17:29:07.350  INFO 35406 --- [nio-8080-exec-1] com.winterchen.config.DataSourceAspect   : &gt;&gt;insert 方法使用的数据源为:insert&lt;&lt;<br>2018-05-30 17:29:07.351  INFO 35406 --- [nio-8080-exec-1] com.winterchen.config.DataSourceAspect   : &gt;&gt;insert方法使用的数据源为:DatabaseType&#123;name&#x3D;&#39;write&#39;&#125;&lt;&lt;<br>2018-05-30 17:29:07.461  INFO 35406 --- [nio-8080-exec-1] com.winterchen.config.DynamicDataSource  : &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;dataSource &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;DatabaseType&#123;name&#x3D;&#39;write&#39;&#125;<br>2018-05-30 17:29:07.462  INFO 35406 --- [nio-8080-exec-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...<br>2018-05-30 17:29:07.952  INFO 35406 --- [nio-8080-exec-1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.<br></code></pre></td></tr></table></figure>\n\n<p>可以看出使用的就是<code>write</code>数据源，并且该数据源是使用<code>HikariPool</code>作为数据库连接池的</p>\n<p>查询用户（read）：</p>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464129009.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">查询用户</span></p>\n<p>日志：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">2018-05-30 17:29:41.616  INFO 35406 --- [nio-8080-exec-2] com.winterchen.config.DataSourceAspect   : className:com.sun.proxy.$Proxy73, method:selectUsers, args:<br>2018-05-30 17:29:41.618  INFO 35406 --- [nio-8080-exec-2] com.winterchen.config.DataSourceAspect   : &gt;&gt;selectUsers 方法使用的数据源为:select&lt;&lt;<br>2018-05-30 17:29:41.618  INFO 35406 --- [nio-8080-exec-2] com.winterchen.config.DataSourceAspect   : &gt;&gt;selectUsers方法使用的数据源为:DatabaseType&#123;name&#x3D;&#39;read&#39;&#125;&lt;&lt;<br>2018-05-30 17:29:41.693  INFO 35406 --- [nio-8080-exec-2] com.winterchen.config.DynamicDataSource  : &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;dataSource &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;DatabaseType&#123;name&#x3D;&#39;read&#39;&#125;<br>2018-05-30 17:29:41.982  INFO 35406 --- [nio-8080-exec-2] com.alibaba.druid.pool.DruidDataSource   : &#123;dataSource-1&#125; inited<br></code></pre></td></tr></table></figure>\n\n<p>可以看出使用的是<code>read</code>数据源。</p>\n<p>源码地址：<a href=\"https://github.com/WinterChenS/springboot-learning-experience/tree/master/spring-boot-mybatis-mutil-database\" target=\"_blank\" rel=\"noopener\">戳这里</a></p>\n<p>springboot技术交流群：681513531</p>\n","raw":null,"categories":[{"name":"Spring Boot","path":"api/categories/Spring Boot.json"}],"tags":[{"name":"Spring Boot","path":"api/tags/Spring Boot.json"},{"name":"mybatis","path":"api/tags/mybatis.json"}]},{"title":"Spring boot Mybatis 整合（完整版）","slug":"springboot-mybatis","date":"2017-09-25T15:41:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/springboot-mybatis.json","excerpt":" [Figure] 本项目使用的环境：开发工具：Intellij IDEA 2017.1.3jdk：1.8.0_161maven:3.3.9","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046780594770.jpg","content":"<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046780820013.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><strong>本项目使用的环境：</strong></p>\n<ul>\n<li>开发工具：Intellij IDEA 2017.1.3</li>\n<li>jdk：1.8.0_161</li>\n<li>maven:3.3.9<a id=\"more\"></a>\n\n</li>\n</ul>\n<p><strong>额外功能</strong></p>\n<ul>\n<li>PageHelper 分页插件</li>\n<li>mybatis generator 自动生成代码插件</li>\n</ul>\n<p><strong>步骤：</strong><br><strong>1.创建一个springboot项目：</strong><br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464261112.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span><br><strong>2.创建项目的文件结构以及jdk的版本</strong><br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464366644.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span><br><strong>3.选择项目所需要的依赖</strong><br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464475646.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span><br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464579648.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span><br>然后点击finish</p>\n<p><strong>5.看一下文件的结构：</strong><br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464693133.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p><strong>6.查看一下pom.xml：</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project</span> <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://maven.apache.org/POM/4.0.0\"</span> <span class=\"hljs-attr\">xmlns:xsi</span>=<span class=\"hljs-string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">xsi:schemaLocation</span>=<span class=\"hljs-string\">\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">modelVersion</span>&gt;</span>4.0.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">modelVersion</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.winter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>springboot-mybatis-demo<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">packaging</span>&gt;</span>jar<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">packaging</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">name</span>&gt;</span>springboot-mybatis-demo<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">name</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">description</span>&gt;</span>Demo project for Spring Boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">description</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">parent</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.5.6.RELEASE<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">relativePath</span>/&gt;</span> <span class=\"hljs-comment\">&lt;!-- lookup parent from repository --&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">parent</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">properties</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project.build.sourceEncoding</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project.reporting.outputEncoding</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">java.version</span>&gt;</span>1.7<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">java.version</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">properties</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.3.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>mysql<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>5.1.35<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-comment\">&lt;!-- alibaba的druid数据库连接池 --&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.alibaba<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>druid<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.0.11<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-databind<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.datatype<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-datatype-joda<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.module<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-module-parameter-names<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-comment\">&lt;!-- 分页插件 --&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.github.pagehelper<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.1.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-comment\">&lt;!-- alibaba的druid数据库连接池 --&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.alibaba<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>druid-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.1.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">build</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">plugins</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t\t<span class=\"hljs-comment\">&lt;!-- mybatis generator 自动生成代码插件 --&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.3.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">configuration</span>&gt;</span><br>\t\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">configurationFile</span>&gt;</span>$&#123;basedir&#125;/src/main/resources/generator/generatorConfig.xml<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">configurationFile</span>&gt;</span><br>\t\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">overwrite</span>&gt;</span>true<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">overwrite</span>&gt;</span><br>\t\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">verbose</span>&gt;</span>true<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">verbose</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">configuration</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">plugins</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">build</span>&gt;</span><br><br><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p><strong>7.项目不使用application.properties文件 而使用更加简洁的application.yml文件：</strong><br><strong>将原有的resource文件夹下的application.properties文件删除，创建一个新的application.yml配置文件，</strong><br><strong>文件的内容如下：</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><br><span class=\"hljs-attr\">server:</span><br>  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">8080</span><br><br><span class=\"hljs-attr\">spring:</span><br>    <span class=\"hljs-attr\">datasource:</span><br>        <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">test</span><br>        <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/depot</span><br>        <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span><br>        <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span><br>        <span class=\"hljs-comment\"># 使用druid数据源</span><br>        <span class=\"hljs-attr\">type:</span> <span class=\"hljs-string\">com.alibaba.druid.pool.DruidDataSource</span><br>        <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span><br>        <span class=\"hljs-attr\">filters:</span> <span class=\"hljs-string\">stat</span><br>        <span class=\"hljs-attr\">maxActive:</span> <span class=\"hljs-number\">20</span><br>        <span class=\"hljs-attr\">initialSize:</span> <span class=\"hljs-number\">1</span><br>        <span class=\"hljs-attr\">maxWait:</span> <span class=\"hljs-number\">60000</span><br>        <span class=\"hljs-attr\">minIdle:</span> <span class=\"hljs-number\">1</span><br>        <span class=\"hljs-attr\">timeBetweenEvictionRunsMillis:</span> <span class=\"hljs-number\">60000</span><br>        <span class=\"hljs-attr\">minEvictableIdleTimeMillis:</span> <span class=\"hljs-number\">300000</span><br>        <span class=\"hljs-attr\">validationQuery:</span> <span class=\"hljs-string\">select</span> <span class=\"hljs-string\">'x'</span><br>        <span class=\"hljs-attr\">testWhileIdle:</span> <span class=\"hljs-literal\">true</span><br>        <span class=\"hljs-attr\">testOnBorrow:</span> <span class=\"hljs-literal\">false</span><br>        <span class=\"hljs-attr\">testOnReturn:</span> <span class=\"hljs-literal\">false</span><br>        <span class=\"hljs-attr\">poolPreparedStatements:</span> <span class=\"hljs-literal\">true</span><br>        <span class=\"hljs-attr\">maxOpenPreparedStatements:</span> <span class=\"hljs-number\">20</span><br><span class=\"hljs-attr\">mybatis:</span><br>  <span class=\"hljs-attr\">mapper-locations:</span> <span class=\"hljs-string\">classpath:mapping/*.xml</span><br>  <span class=\"hljs-attr\">type-aliases-package:</span> <span class=\"hljs-string\">com.winter.model</span><br><br><span class=\"hljs-comment\">#pagehelper分页插件</span><br><span class=\"hljs-attr\">pagehelper:</span><br>    <span class=\"hljs-attr\">helperDialect:</span> <span class=\"hljs-string\">mysql</span><br>    <span class=\"hljs-attr\">reasonable:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">supportMethodsArguments:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">params:</span> <span class=\"hljs-string\">count=countSql</span><br></code></pre></td></tr></table></figure>\n<p><strong>8.创建数据库：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs mysql\">CREATE DATABASE mytest;<br><br>CREATE TABLE t_user(<br>  user_id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,<br>  user_name VARCHAR(255) NOT NULL ,<br>  password VARCHAR(255) NOT NULL ,<br>  phone VARCHAR(255) NOT NULL<br>) ENGINE&#x3D;INNODB AUTO_INCREMENT&#x3D;1000 DEFAULT CHARSET&#x3D;utf8;<br></code></pre></td></tr></table></figure>\n<p><strong>9.使用mybatis generator 自动生成代码：</strong></p>\n<ul>\n<li>配置pom.xml中generator 插件所对应的配置文件       ${basedir}/src/main/resources/generator/generatorConfig.xml</li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-meta-keyword\">generatorConfiguration</span></span><br><span class=\"hljs-meta\">        <span class=\"hljs-meta-keyword\">PUBLIC</span> <span class=\"hljs-meta-string\">\"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\"</span></span><br><span class=\"hljs-meta\">        <span class=\"hljs-meta-string\">\"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\"</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">generatorConfiguration</span>&gt;</span><br>    <span class=\"hljs-comment\">&lt;!-- 数据库驱动:选择你的本地硬盘上面的数据库驱动包--&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">classPathEntry</span>  <span class=\"hljs-attr\">location</span>=<span class=\"hljs-string\">\"E:\\developer\\mybatis-generator-core-1.3.2\\lib\\mysql-connector-java-5.1.25-bin.jar\"</span>/&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">context</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"DB2Tables\"</span>  <span class=\"hljs-attr\">targetRuntime</span>=<span class=\"hljs-string\">\"MyBatis3\"</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">commentGenerator</span>&gt;</span><br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"suppressDate\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"true\"</span>/&gt;</span><br>            <span class=\"hljs-comment\">&lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span><br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"suppressAllComments\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"true\"</span>/&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">commentGenerator</span>&gt;</span><br>        <span class=\"hljs-comment\">&lt;!--数据库链接URL，用户名、密码 --&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">jdbcConnection</span> <span class=\"hljs-attr\">driverClass</span>=<span class=\"hljs-string\">\"com.mysql.jdbc.Driver\"</span> <span class=\"hljs-attr\">connectionURL</span>=<span class=\"hljs-string\">\"jdbc:mysql://127.0.0.1/mytest\"</span> <span class=\"hljs-attr\">userId</span>=<span class=\"hljs-string\">\"root\"</span> <span class=\"hljs-attr\">password</span>=<span class=\"hljs-string\">\"root\"</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">jdbcConnection</span>&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">javaTypeResolver</span>&gt;</span><br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"forceBigDecimals\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"false\"</span>/&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">javaTypeResolver</span>&gt;</span><br>        <span class=\"hljs-comment\">&lt;!-- 生成模型的包名和位置--&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">javaModelGenerator</span> <span class=\"hljs-attr\">targetPackage</span>=<span class=\"hljs-string\">\"com.winter.model\"</span> <span class=\"hljs-attr\">targetProject</span>=<span class=\"hljs-string\">\"src/main/java\"</span>&gt;</span><br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"enableSubPackages\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"true\"</span>/&gt;</span><br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"trimStrings\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"true\"</span>/&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">javaModelGenerator</span>&gt;</span><br>        <span class=\"hljs-comment\">&lt;!-- 生成映射文件的包名和位置--&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sqlMapGenerator</span> <span class=\"hljs-attr\">targetPackage</span>=<span class=\"hljs-string\">\"mapping\"</span> <span class=\"hljs-attr\">targetProject</span>=<span class=\"hljs-string\">\"src/main/resources\"</span>&gt;</span><br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"enableSubPackages\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"true\"</span>/&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sqlMapGenerator</span>&gt;</span><br>        <span class=\"hljs-comment\">&lt;!-- 生成DAO的包名和位置--&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">javaClientGenerator</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"XMLMAPPER\"</span> <span class=\"hljs-attr\">targetPackage</span>=<span class=\"hljs-string\">\"com.winter.mapper\"</span> <span class=\"hljs-attr\">targetProject</span>=<span class=\"hljs-string\">\"src/main/java\"</span>&gt;</span><br>            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">\"enableSubPackages\"</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">\"true\"</span>/&gt;</span><br>        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">javaClientGenerator</span>&gt;</span><br>        <span class=\"hljs-comment\">&lt;!-- 要生成的表 tableName是数据库中的表名或视图名 domainObjectName是实体类名--&gt;</span><br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">table</span> <span class=\"hljs-attr\">tableName</span>=<span class=\"hljs-string\">\"t_user\"</span> <span class=\"hljs-attr\">domainObjectName</span>=<span class=\"hljs-string\">\"User\"</span> <span class=\"hljs-attr\">enableCountByExample</span>=<span class=\"hljs-string\">\"false\"</span> <span class=\"hljs-attr\">enableUpdateByExample</span>=<span class=\"hljs-string\">\"false\"</span> <span class=\"hljs-attr\">enableDeleteByExample</span>=<span class=\"hljs-string\">\"false\"</span> <span class=\"hljs-attr\">enableSelectByExample</span>=<span class=\"hljs-string\">\"false\"</span> <span class=\"hljs-attr\">selectByExampleQueryId</span>=<span class=\"hljs-string\">\"false\"</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">table</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">context</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">generatorConfiguration</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n\n<ul>\n<li>点击run-Edit Configurations </li>\n</ul>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464807165.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<ul>\n<li>添加配置</li>\n</ul>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046464921174.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<ul>\n<li><p>运行<br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046465025562.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p>  最后生成的文件以及结构：</p>\n</li>\n</ul>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046465055490.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p><strong>10. 生成的文件</strong></p>\n<p><strong>UserMapper.java</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winter.mapper;<br><br><span class=\"hljs-keyword\">import</span> com.winter.model.User;<br><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">UserMapper</span> </span>&#123;<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">deleteByPrimaryKey</span><span class=\"hljs-params\">(Integer userId)</span></span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">insert</span><span class=\"hljs-params\">(User record)</span></span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">insertSelective</span><span class=\"hljs-params\">(User record)</span></span>;<br><br>    <span class=\"hljs-function\">User <span class=\"hljs-title\">selectByPrimaryKey</span><span class=\"hljs-params\">(Integer userId)</span></span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">updateByPrimaryKeySelective</span><span class=\"hljs-params\">(User record)</span></span>;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">updateByPrimaryKey</span><span class=\"hljs-params\">(User record)</span></span>;<br>\t<span class=\"hljs-comment\">//这个方式我自己加的</span><br>\t<span class=\"hljs-function\">List&lt;User&gt; <span class=\"hljs-title\">selectAllUser</span><span class=\"hljs-params\">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><strong>User.java</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winter.model;<br><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">User</span> </span>&#123;<br>    <span class=\"hljs-keyword\">private</span> Integer userId;<br><br>    <span class=\"hljs-keyword\">private</span> String userName;<br><br>    <span class=\"hljs-keyword\">private</span> String password;<br><br>    <span class=\"hljs-keyword\">private</span> String phone;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> Integer <span class=\"hljs-title\">getUserId</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> userId;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setUserId</span><span class=\"hljs-params\">(Integer userId)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.userId = userId;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title\">getUserName</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> userName;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setUserName</span><span class=\"hljs-params\">(String userName)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.userName = userName == <span class=\"hljs-keyword\">null</span> ? <span class=\"hljs-keyword\">null</span> : userName.trim();<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title\">getPassword</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> password;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setPassword</span><span class=\"hljs-params\">(String password)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.password = password == <span class=\"hljs-keyword\">null</span> ? <span class=\"hljs-keyword\">null</span> : password.trim();<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title\">getPhone</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> phone;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setPhone</span><span class=\"hljs-params\">(String phone)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.phone = phone == <span class=\"hljs-keyword\">null</span> ? <span class=\"hljs-keyword\">null</span> : phone.trim();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n<p>对于sql语句这种黄色的背景，真心是看不下去了（解决方案）：<br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046465130102.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p>*<em>UserMapper.xml    *</em></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><br><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-meta-keyword\">mapper</span> <span class=\"hljs-meta-keyword\">PUBLIC</span> <span class=\"hljs-meta-string\">\"-//mybatis.org//DTD Mapper 3.0//EN\"</span> <span class=\"hljs-meta-string\">\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"</span> &gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">mapper</span> <span class=\"hljs-attr\">namespace</span>=<span class=\"hljs-string\">\"com.winter.mapper.UserMapper\"</span> &gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">resultMap</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"BaseResultMap\"</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">\"com.winter.model.User\"</span> &gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">id</span> <span class=\"hljs-attr\">column</span>=<span class=\"hljs-string\">\"user_id\"</span> <span class=\"hljs-attr\">property</span>=<span class=\"hljs-string\">\"userId\"</span> <span class=\"hljs-attr\">jdbcType</span>=<span class=\"hljs-string\">\"INTEGER\"</span> /&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">result</span> <span class=\"hljs-attr\">column</span>=<span class=\"hljs-string\">\"user_name\"</span> <span class=\"hljs-attr\">property</span>=<span class=\"hljs-string\">\"userName\"</span> <span class=\"hljs-attr\">jdbcType</span>=<span class=\"hljs-string\">\"VARCHAR\"</span> /&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">result</span> <span class=\"hljs-attr\">column</span>=<span class=\"hljs-string\">\"password\"</span> <span class=\"hljs-attr\">property</span>=<span class=\"hljs-string\">\"password\"</span> <span class=\"hljs-attr\">jdbcType</span>=<span class=\"hljs-string\">\"VARCHAR\"</span> /&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">result</span> <span class=\"hljs-attr\">column</span>=<span class=\"hljs-string\">\"phone\"</span> <span class=\"hljs-attr\">property</span>=<span class=\"hljs-string\">\"phone\"</span> <span class=\"hljs-attr\">jdbcType</span>=<span class=\"hljs-string\">\"VARCHAR\"</span> /&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">resultMap</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sql</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"Base_Column_List\"</span> &gt;</span><br>    user_id, user_name, password, phone<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sql</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">select</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"selectByPrimaryKey\"</span> <span class=\"hljs-attr\">resultMap</span>=<span class=\"hljs-string\">\"BaseResultMap\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"java.lang.Integer\"</span> &gt;</span><br>    select <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"Base_Column_List\"</span> /&gt;</span><br>    from t_user<br>    where user_id = #&#123;userId,jdbcType=INTEGER&#125;<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">select</span>&gt;</span><br>  <span class=\"hljs-comment\">&lt;!-- 这个方法是我自己加的 --&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">select</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"selectAllUser\"</span> <span class=\"hljs-attr\">resultMap</span>=<span class=\"hljs-string\">\"BaseResultMap\"</span>&gt;</span><br>    select<br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"Base_Column_List\"</span> /&gt;</span><br>    from t_user<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">select</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">delete</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"deleteByPrimaryKey\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"java.lang.Integer\"</span> &gt;</span><br>    delete from t_user<br>    where user_id = #&#123;userId,jdbcType=INTEGER&#125;<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">delete</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">insert</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"insert\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"com.winter.model.User\"</span> &gt;</span><br>    insert into t_user (user_id, user_name, password, <br>      phone)<br>    values (#&#123;userId,jdbcType=INTEGER&#125;, #&#123;userName,jdbcType=VARCHAR&#125;, #&#123;password,jdbcType=VARCHAR&#125;, <br>      #&#123;phone,jdbcType=VARCHAR&#125;)<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">insert</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">insert</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"insertSelective\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"com.winter.model.User\"</span> &gt;</span><br>    insert into t_user<br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">trim</span> <span class=\"hljs-attr\">prefix</span>=<span class=\"hljs-string\">\"(\"</span> <span class=\"hljs-attr\">suffix</span>=<span class=\"hljs-string\">\")\"</span> <span class=\"hljs-attr\">suffixOverrides</span>=<span class=\"hljs-string\">\",\"</span> &gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"userId != null\"</span> &gt;</span><br>        user_id,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"userName != null\"</span> &gt;</span><br>        user_name,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"password != null\"</span> &gt;</span><br>        password,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span> &gt;</span><br>        phone,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">trim</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">trim</span> <span class=\"hljs-attr\">prefix</span>=<span class=\"hljs-string\">\"values (\"</span> <span class=\"hljs-attr\">suffix</span>=<span class=\"hljs-string\">\")\"</span> <span class=\"hljs-attr\">suffixOverrides</span>=<span class=\"hljs-string\">\",\"</span> &gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"userId != null\"</span> &gt;</span><br>        #&#123;userId,jdbcType=INTEGER&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"userName != null\"</span> &gt;</span><br>        #&#123;userName,jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"password != null\"</span> &gt;</span><br>        #&#123;password,jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span> &gt;</span><br>        #&#123;phone,jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">trim</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">insert</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">update</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"updateByPrimaryKeySelective\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"com.winter.model.User\"</span> &gt;</span><br>    update t_user<br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">set</span> &gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"userName != null\"</span> &gt;</span><br>        user_name = #&#123;userName,jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"password != null\"</span> &gt;</span><br>        password = #&#123;password,jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span> &gt;</span><br>        phone = #&#123;phone,jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">set</span>&gt;</span><br>    where user_id = #&#123;userId,jdbcType=INTEGER&#125;<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">update</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">update</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"updateByPrimaryKey\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"com.winter.model.User\"</span> &gt;</span><br>    update t_user<br>    set user_name = #&#123;userName,jdbcType=VARCHAR&#125;,<br>      password = #&#123;password,jdbcType=VARCHAR&#125;,<br>      phone = #&#123;phone,jdbcType=VARCHAR&#125;<br>    where user_id = #&#123;userId,jdbcType=INTEGER&#125;<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">update</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p><strong>11.打开类SpringbootMybatisDemoApplication.java，这个是springboot的启动类。我们需要添加点东西：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winter;<br><br><span class=\"hljs-keyword\">import</span> org.mybatis.spring.annotation.MapperScan;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.SpringApplication;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class=\"hljs-meta\">@SpringBootApplication</span><br><span class=\"hljs-meta\">@MapperScan</span>(<span class=\"hljs-string\">\"com.winter.mapper\"</span>)<span class=\"hljs-comment\">//将项目中对应的mapper类的路径加进来就可以了</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">SpringbootMybatisDemoApplication</span> </span>&#123;<br><br>\t<span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span> </span>&#123;<br>\t\tSpringApplication.run(SpringbootMybatisDemoApplication<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>, <span class=\"hljs-title\">args</span>)</span>;<br>\t&#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><strong>12.到这里所有的搭建工作都完成了，接下来就是测试的工作，没使用junit4进行测试：</strong><br><strong>首先看一下完成之后的文件的结构：</strong><br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046465294088.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p><strong>现在controller，service层的代码都写好：</strong></p>\n<p><strong>UserController.java</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winter.Controller;<br><br><span class=\"hljs-keyword\">import</span> com.winter.model.User;<br><span class=\"hljs-keyword\">import</span> com.winter.service.UserService;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.stereotype.Controller;<br><span class=\"hljs-keyword\">import</span> org.springframework.web.bind.annotation.PathVariable;<br><span class=\"hljs-keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class=\"hljs-keyword\">import</span> org.springframework.web.bind.annotation.ResponseBody;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2017/8/16.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Controller</span><br><span class=\"hljs-meta\">@RequestMapping</span>(value = <span class=\"hljs-string\">\"/user\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserController</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> UserService userService;<br><br>    <span class=\"hljs-meta\">@ResponseBody</span><br>    <span class=\"hljs-meta\">@RequestMapping</span>(value = <span class=\"hljs-string\">\"/add\"</span>, produces = &#123;<span class=\"hljs-string\">\"application/json;charset=UTF-8\"</span>&#125;)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">addUser</span><span class=\"hljs-params\">(User user)</span></span>&#123;<br>        <span class=\"hljs-keyword\">return</span> userService.addUser(user);<br>    &#125;<br><br>\t<span class=\"hljs-meta\">@ResponseBody</span><br>    <span class=\"hljs-meta\">@RequestMapping</span>(value = <span class=\"hljs-string\">\"/all/&#123;pageNum&#125;/&#123;pageSize&#125;\"</span>, produces = &#123;<span class=\"hljs-string\">\"application/json;charset=UTF-8\"</span>&#125;)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title\">findAllUser</span><span class=\"hljs-params\">(@PathVariable(<span class=\"hljs-string\">\"pageNum\"</span>)</span> <span class=\"hljs-keyword\">int</span> pageNum, @<span class=\"hljs-title\">PathVariable</span><span class=\"hljs-params\">(<span class=\"hljs-string\">\"pageSize\"</span>)</span> <span class=\"hljs-keyword\">int</span> pageSize)</span>&#123;<br><br>        <span class=\"hljs-keyword\">return</span> userService.findAllUser(pageNum,pageSize);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><strong>UserService.java</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winter.service;<br><br><span class=\"hljs-keyword\">import</span> com.winter.model.User;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2017/8/16.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">UserService</span> </span>&#123;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">addUser</span><span class=\"hljs-params\">(User user)</span></span>;<br><br>    <span class=\"hljs-function\">List&lt;User&gt; <span class=\"hljs-title\">findAllUser</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> pageNum, <span class=\"hljs-keyword\">int</span> pageSize)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n<p><strong>UserServiceImpl.java</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winter.service.impl;<br><br><span class=\"hljs-keyword\">import</span> com.github.pagehelper.PageHelper;<br><span class=\"hljs-keyword\">import</span> com.winter.mapper.UserMapper;<br><span class=\"hljs-keyword\">import</span> com.winter.model.User;<br><span class=\"hljs-keyword\">import</span> com.winter.service.UserService;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.stereotype.Service;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2017/8/16.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Service</span>(value = <span class=\"hljs-string\">\"userService\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserServiceImpl</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">UserService</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> UserMapper userMapper;<span class=\"hljs-comment\">//这里会报错，但是并不会影响</span><br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">addUser</span><span class=\"hljs-params\">(User user)</span> </span>&#123;<br><br>        <span class=\"hljs-keyword\">return</span> userMapper.insertSelective(user);<br>    &#125;<br><br>    <span class=\"hljs-comment\">/*</span><br><span class=\"hljs-comment\">    * 这个方法中用到了我们开头配置依赖的分页插件pagehelper</span><br><span class=\"hljs-comment\">    * 很简单，只需要在service层传入参数，然后将参数传递给一个插件的一个静态方法即可；</span><br><span class=\"hljs-comment\">    * pageNum 开始页数</span><br><span class=\"hljs-comment\">    * pageSize 每页显示的数据条数</span><br><span class=\"hljs-comment\">    * */</span><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> List&lt;User&gt; <span class=\"hljs-title\">findAllUser</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> pageNum, <span class=\"hljs-keyword\">int</span> pageSize)</span> </span>&#123;<br>        <span class=\"hljs-comment\">//将参数传给这个方法就可以实现物理分页了，非常简单。</span><br>        PageHelper.startPage(pageNum, pageSize);<br>        <span class=\"hljs-keyword\">return</span> userMapper.selectAllUser();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>如果强迫症看不下去那个报错：（解决方法）<br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046465377128.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p><strong>测试我使用了idea一个很用心的功能。</strong><br><strong>可以发http请求的插件</strong>：<br><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046466520408.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046466577040.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">这里写图片描述</span></p>\n<p>点击左侧的运行按钮就可以发送请求了；<br>如果返回值正确 说明你已经搭建成功了！！</p>\n<p><strong>如果大家想使用事务控制的话，请参照<a href=\"http://blog.csdn.net/Winter_chen001/article/details/78622141\" target=\"_blank\" rel=\"noopener\">Spring boot Mybatis 整合（注解版）</a> ,这个里面就有关于事务控制的使用</strong></p>\n<p>源码地址：<a href=\"https://github.com/WinterChenS/springboot-mybatis-demo\" target=\"_blank\" rel=\"noopener\">https://github.com/WinterChenS/springboot-mybatis-demo</a></p>\n","raw":null,"categories":[{"name":"Spring Boot","path":"api/categories/Spring Boot.json"}],"tags":[{"name":"Spring Boot","path":"api/tags/Spring Boot.json"},{"name":"mybatis","path":"api/tags/mybatis.json"}]},{"title":"springboot2.0 Mybatis 整合 (springboot2.0版本)","slug":"springboot2-mybatis","date":"2018-04-20T16:57:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/springboot2-mybatis.json","excerpt":" [Figure] springboot终于迎来了2.0版本，很多新的特性让springboot更加强大，之前使用1.5.6版本整合了Mybatis，现在2.0版本就已经不适用了，所以，在摸索中搭建了2.0版本整合Mybatis","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046782543036.jpg","content":"<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046782791380.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<blockquote>\n<p>springboot终于迎来了2.0版本，很多新的特性让springboot更加强大，之前<a href=\"https://blog.csdn.net/winter_chen001/article/details/77249029\" target=\"_blank\" rel=\"noopener\">使用1.5.6版本整合了Mybatis</a>，现在2.0版本就已经不适用了，所以，在摸索中搭建了2.0版本整合Mybatis</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<h2 id=\"写在前面\"><a href=\"#写在前面\" class=\"headerlink\" title=\"写在前面\"></a>写在前面</h2><p>本来这篇博文老在就写好了，但是后来发现很多功能其实根本就没有检验通过就发出来了，导致遗留了很多坑，比如最难搞的就是SqlSessionFactory和PageHelper，之前写过关于springboot1.5.6版本的整合，这段时间刚好springboot发布了2.0的正式版本，很多同学可能没有注意版本，导致了整合的时候出现了很多很多的问题，这几天刚好有空就试着整合一下springboot2.0 mybatis，发现了很多很多的坑，而且网上的资源也不多，终于在两天的踩坑中成功整合了，并且将翻页功能修复好了，废话不多说了，看代码：</p>\n<h2 id=\"环境-版本一览：\"><a href=\"#环境-版本一览：\" class=\"headerlink\" title=\"环境/版本一览：\"></a>环境/版本一览：</h2><ul>\n<li>开发工具：Intellij IDEA 2017.1.3</li>\n<li>springboot: <strong>2.0.1.RELEASE</strong></li>\n<li>jdk：1.8.0_40</li>\n<li>maven:3.3.9</li>\n<li>alibaba Druid 数据库连接池：1.1.0</li>\n</ul>\n<h3 id=\"额外功能：\"><a href=\"#额外功能：\" class=\"headerlink\" title=\"额外功能：\"></a>额外功能：</h3><ul>\n<li>PageHelper 分页插件</li>\n<li>mybatis generator 自动生成代码插件（本次搭建就不讲解了，请参照<a href=\"https://blog.csdn.net/winter_chen001/article/details/77249029\" target=\"_blank\" rel=\"noopener\">Spring boot Mybatis 整合（完整版）</a>）</li>\n</ul>\n<h2 id=\"开始搭建：\"><a href=\"#开始搭建：\" class=\"headerlink\" title=\"开始搭建：\"></a>开始搭建：</h2><h3 id=\"创建项目：\"><a href=\"#创建项目：\" class=\"headerlink\" title=\"创建项目：\"></a>创建项目：</h3><p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046466648928.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046466698922.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p>添加基础的依赖：<br><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046466739962.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<h3 id=\"依赖文件：\"><a href=\"#依赖文件：\" class=\"headerlink\" title=\"依赖文件：\"></a>依赖文件：</h3><p>按照pom文件补齐需要的依赖：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project</span> <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://maven.apache.org/POM/4.0.0\"</span> <span class=\"hljs-attr\">xmlns:xsi</span>=<span class=\"hljs-string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span><br><span class=\"hljs-tag\">\t<span class=\"hljs-attr\">xsi:schemaLocation</span>=<span class=\"hljs-string\">\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">modelVersion</span>&gt;</span>4.0.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">modelVersion</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.winterchen<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>springboot2-mybatis-demo<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">packaging</span>&gt;</span>jar<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">packaging</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">name</span>&gt;</span>springboot2-mybatis-demo<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">name</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">description</span>&gt;</span>Demo project for Spring Boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">description</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">parent</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.0.1.RELEASE<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">relativePath</span>/&gt;</span> <span class=\"hljs-comment\">&lt;!-- lookup parent from repository --&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">parent</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">properties</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project.build.sourceEncoding</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project.reporting.outputEncoding</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">java.version</span>&gt;</span>1.8<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">java.version</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">properties</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.3.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>mysql<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>runtime<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.apache.commons<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>commons-lang3<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>3.4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><br><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-databind<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.datatype<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-datatype-joda<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.module<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-module-parameter-names<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-comment\">&lt;!-- 分页插件 --&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.github.pagehelper<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>pagehelper<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>5.1.3<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t<span class=\"hljs-comment\">&lt;!-- alibaba的druid数据库连接池 --&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.alibaba<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>druid-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.1.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span><br><br>\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">build</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">plugins</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>\t\t\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>\t\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">plugin</span>&gt;</span><br>\t\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">plugins</span>&gt;</span><br>\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">build</span>&gt;</span><br><br><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">project</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"项目结构：\"><a href=\"#项目结构：\" class=\"headerlink\" title=\"项目结构：\"></a>项目结构：</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046466825127.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">项目结构</span></p>\n<h4 id=\"项目启动类：\"><a href=\"#项目启动类：\" class=\"headerlink\" title=\"项目启动类：\"></a>项目启动类：</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen;<br><br><span class=\"hljs-keyword\">import</span> org.springframework.boot.SpringApplication;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class=\"hljs-meta\">@SpringBootApplication</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Springboot2MybatisDemoApplication</span> </span>&#123;<br><br>\t<span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span> </span>&#123;<br>\t\tSpringApplication.run(Springboot2MybatisDemoApplication<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>, <span class=\"hljs-title\">args</span>)</span>;<br>\t&#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"配置：\"><a href=\"#配置：\" class=\"headerlink\" title=\"配置：\"></a>配置：</h3><blockquote>\n<p>可以根据个人使用习惯选择使用<code>properties</code>或者<code>yml</code>文件，本项目使用的是yml配置文件，所以把原本<code>application.properties</code>删除，创建一个<code>application.yml</code>文件</p>\n</blockquote>\n<p>在resource文件夹下创建<code>application.yml</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">server:</span><br>  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">8080</span><br><br><br><span class=\"hljs-attr\">spring:</span><br>    <span class=\"hljs-attr\">datasource:</span><br>        <span class=\"hljs-attr\">name:</span> <span class=\"hljs-string\">test</span><br>        <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://127.0.0.1:3306/mytest?useUnicode=true&amp;characterEncoding=UTF-8&amp;allowMultiQueries=true</span><br>        <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span><br>        <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span><br>        <span class=\"hljs-comment\"># 使用druid数据源</span><br>        <span class=\"hljs-attr\">type:</span> <span class=\"hljs-string\">com.alibaba.druid.pool.DruidDataSource</span><br>        <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span><br>        <span class=\"hljs-attr\">filters:</span> <span class=\"hljs-string\">stat</span><br>        <span class=\"hljs-attr\">maxActive:</span> <span class=\"hljs-number\">20</span><br>        <span class=\"hljs-attr\">initialSize:</span> <span class=\"hljs-number\">1</span><br>        <span class=\"hljs-attr\">maxWait:</span> <span class=\"hljs-number\">60000</span><br>        <span class=\"hljs-attr\">minIdle:</span> <span class=\"hljs-number\">1</span><br>        <span class=\"hljs-attr\">timeBetweenEvictionRunsMillis:</span> <span class=\"hljs-number\">60000</span><br>        <span class=\"hljs-attr\">minEvictableIdleTimeMillis:</span> <span class=\"hljs-number\">300000</span><br>        <span class=\"hljs-attr\">validationQuery:</span> <span class=\"hljs-string\">select</span> <span class=\"hljs-string\">'x'</span><br>        <span class=\"hljs-attr\">testWhileIdle:</span> <span class=\"hljs-literal\">true</span><br>        <span class=\"hljs-attr\">testOnBorrow:</span> <span class=\"hljs-literal\">false</span><br>        <span class=\"hljs-attr\">testOnReturn:</span> <span class=\"hljs-literal\">false</span><br>        <span class=\"hljs-attr\">poolPreparedStatements:</span> <span class=\"hljs-literal\">true</span><br>        <span class=\"hljs-attr\">maxPoolPreparedStatementPerConnectionSize:</span> <span class=\"hljs-number\">20</span><br>        <span class=\"hljs-attr\">maxOpenPreparedStatements:</span> <span class=\"hljs-number\">20</span><br>        <br><span class=\"hljs-attr\">mybatis:</span><br>  <span class=\"hljs-attr\">mapper-locations:</span> <span class=\"hljs-string\">classpath:mapper/*.xml</span><br>  <span class=\"hljs-attr\">type-aliases-package:</span> <span class=\"hljs-string\">com.winterchen.model</span><br><br><span class=\"hljs-attr\">mapper:</span><br>  <span class=\"hljs-attr\">mappers:</span>  <span class=\"hljs-string\">com.winterchen.dao</span><br>  <span class=\"hljs-attr\">not-empty:</span> <span class=\"hljs-literal\">false</span><br>  <span class=\"hljs-attr\">identity:</span> <span class=\"hljs-string\">MYSQL</span><br><br><span class=\"hljs-comment\">#pagehelper</span><br><span class=\"hljs-attr\">pagehelper:</span><br>    <span class=\"hljs-attr\">helperDialect:</span> <span class=\"hljs-string\">mysql</span><br>    <span class=\"hljs-attr\">reasonable:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">supportMethodsArguments:</span> <span class=\"hljs-literal\">true</span><br>    <span class=\"hljs-attr\">params:</span> <span class=\"hljs-string\">count=countSql</span><br>    <span class=\"hljs-attr\">returnPageInfo:</span> <span class=\"hljs-string\">check</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"创建包：\"><a href=\"#创建包：\" class=\"headerlink\" title=\"创建包：\"></a>创建包：</h3><p><code>model</code>，<code>dao</code>，<code>mapper</code>,<code>config</code></p>\n<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046466881978.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<h3 id=\"新建配置类：\"><a href=\"#新建配置类：\" class=\"headerlink\" title=\"新建配置类：\"></a>新建配置类：</h3><p><code>PageHelperConfig.java</code></p>\n<blockquote>\n<p>以下配置非常的重要，<code>PageHelper</code>的Page拦截器<code>PageInterceptor</code>，如果不进行配置，那么分页功能将没有效果</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.config;<br><br><span class=\"hljs-keyword\">import</span> com.github.pagehelper.PageInterceptor;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Value;<br><span class=\"hljs-keyword\">import</span> org.springframework.context.annotation.Bean;<br><span class=\"hljs-keyword\">import</span> org.springframework.context.annotation.Configuration;<br><br><span class=\"hljs-keyword\">import</span> java.util.Properties;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 分页插件的配置</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/4/20.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">PageHelperConfig</span> </span>&#123;<br><br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;pagehelper.helperDialect&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String helperDialect;<br>    <br><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> PageInterceptor <span class=\"hljs-title\">pageInterceptor</span><span class=\"hljs-params\">()</span></span>&#123;<br>        PageInterceptor pageInterceptor = <span class=\"hljs-keyword\">new</span> PageInterceptor();<br>        Properties properties = <span class=\"hljs-keyword\">new</span> Properties();<br>        properties.setProperty(<span class=\"hljs-string\">\"helperDialect\"</span>, helperDialect);<br>        pageInterceptor.setProperties(properties);<br>        <span class=\"hljs-keyword\">return</span> pageInterceptor;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n<p><code>DataSourceConfig.java</code></p>\n<blockquote>\n<p>在springboot2.0版本，如果不定义<code>SqlSessionFactory</code>，那么将会导致错误，因为无法注入<code>SqlSessionFactory</code>，<strong>并且下面注释部分的内容非常的重要，这也是整合当中遇到的很大的坑，如果不将PageInterceptor作为插件设置到SqlSessionFactoryBean中，导致分页失效</strong></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.config;<br><br><span class=\"hljs-keyword\">import</span> com.github.pagehelper.PageHelper;<br><span class=\"hljs-keyword\">import</span> com.github.pagehelper.PageInterceptor;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.plugin.Interceptor;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.session.SqlSessionFactory;<br><span class=\"hljs-keyword\">import</span> org.mybatis.spring.SqlSessionFactoryBean;<br><span class=\"hljs-keyword\">import</span> org.mybatis.spring.annotation.MapperScan;<br><span class=\"hljs-keyword\">import</span> org.slf4j.Logger;<br><span class=\"hljs-keyword\">import</span> org.slf4j.LoggerFactory;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Qualifier;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class=\"hljs-keyword\">import</span> org.springframework.boot.jdbc.DataSourceBuilder;<br><span class=\"hljs-keyword\">import</span> org.springframework.context.annotation.Bean;<br><span class=\"hljs-keyword\">import</span> org.springframework.context.annotation.Configuration;<br><span class=\"hljs-keyword\">import</span> org.springframework.core.env.Environment;<br><span class=\"hljs-keyword\">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;<br><span class=\"hljs-keyword\">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;<br><br><span class=\"hljs-keyword\">import</span> javax.sql.DataSource;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 2018/4/19 18:46</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-meta\">@MapperScan</span>(<span class=\"hljs-string\">\"com.winterchen.dao\"</span>)<br><span class=\"hljs-meta\">@EnableTransactionManagement</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DataSourceConfig</span> </span>&#123;<br><br><br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> Logger logger = LoggerFactory.getLogger(DataSourceConfig<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> Environment env;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> PageInterceptor pageInterceptor;<br><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> SqlSessionFactory <span class=\"hljs-title\">sqlSessionFactory</span><span class=\"hljs-params\">(DataSource dataSource)</span> <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>        SqlSessionFactoryBean fb = <span class=\"hljs-keyword\">new</span> SqlSessionFactoryBean();<br>        fb.setDataSource(dataSource);<br>        <span class=\"hljs-comment\">//该配置非常的重要，如果不将PageInterceptor设置到SqlSessionFactoryBean中，导致分页失效</span><br>        fb.setPlugins(<span class=\"hljs-keyword\">new</span> Interceptor[]&#123;pageInterceptor&#125;);<br>        fb.setTypeAliasesPackage(env.getProperty(<span class=\"hljs-string\">\"mybatis.type-aliases-package\"</span>));<br>        fb.setMapperLocations(<span class=\"hljs-keyword\">new</span> PathMatchingResourcePatternResolver().getResources(env.getProperty(<span class=\"hljs-string\">\"mybatis.mapper-locations\"</span>)));<br>        <span class=\"hljs-keyword\">return</span> fb.getObject();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><code>DruidDBConfig.java</code></p>\n<blockquote>\n<p>在Spring Boot1.4.0中驱动配置信息没有问题，但是连接池的配置信息不再支持这里的配置项，即无法通过配置项直接支持相应的连接池；这里列出的这些配置项可以通过定制化DataSource来实现。<br>  目前Spring Boot中默认支持的连接池有dbcp,dbcp2, tomcat, hikari三种连接池。 </p>\n</blockquote>\n<p>由于Druid暂时不在Spring Bootz中的直接支持，故需要进行配置信息的定制：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.config;<br><br><span class=\"hljs-keyword\">import</span> com.alibaba.druid.pool.DruidDataSource;<br><span class=\"hljs-keyword\">import</span> org.slf4j.Logger;<br><span class=\"hljs-keyword\">import</span> org.slf4j.LoggerFactory;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Value;<br><span class=\"hljs-keyword\">import</span> org.springframework.context.annotation.Bean;<br><span class=\"hljs-keyword\">import</span> org.springframework.context.annotation.Configuration;<br><span class=\"hljs-keyword\">import</span> org.springframework.context.annotation.Primary;<br><br><span class=\"hljs-keyword\">import</span> javax.sql.DataSource;<br><span class=\"hljs-keyword\">import</span> java.sql.SQLException;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/4/19.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DruidDBConfig</span> </span>&#123;<br>    <span class=\"hljs-keyword\">private</span> Logger logger = LoggerFactory.getLogger(DruidDBConfig<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.url&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String dbUrl;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.username&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String username;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.password&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String password;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.driver-class-name&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String driverClassName;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.initialSize&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> initialSize;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.minIdle&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> minIdle;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.maxActive&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> maxActive;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.maxWait&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> maxWait;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.timeBetweenEvictionRunsMillis&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> timeBetweenEvictionRunsMillis;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.minEvictableIdleTimeMillis&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> minEvictableIdleTimeMillis;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.validationQuery&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String validationQuery;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.testWhileIdle&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">boolean</span> testWhileIdle;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.testOnBorrow&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">boolean</span> testOnBorrow;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.testOnReturn&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">boolean</span> testOnReturn;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.poolPreparedStatements&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">boolean</span> poolPreparedStatements;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.maxPoolPreparedStatementPerConnectionSize&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> maxPoolPreparedStatementPerConnectionSize;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"$&#123;spring.datasource.filters&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String filters;<br><br>    <span class=\"hljs-meta\">@Value</span>(<span class=\"hljs-string\">\"&#123;spring.datasource.connectionProperties&#125;\"</span>)<br>    <span class=\"hljs-keyword\">private</span> String connectionProperties;<br><br>    <span class=\"hljs-meta\">@Bean</span>     <span class=\"hljs-comment\">//声明其为Bean实例</span><br>    <span class=\"hljs-meta\">@Primary</span>  <span class=\"hljs-comment\">//在同样的DataSource中，首先使用被标注的DataSource</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> DataSource <span class=\"hljs-title\">dataSource</span><span class=\"hljs-params\">()</span></span>&#123;<br>        DruidDataSource datasource = <span class=\"hljs-keyword\">new</span> DruidDataSource();<br><br>        datasource.setUrl(<span class=\"hljs-keyword\">this</span>.dbUrl);<br>        datasource.setUsername(username);<br>        datasource.setPassword(password);<br>        datasource.setDriverClassName(driverClassName);<br><br>        <span class=\"hljs-comment\">//configuration</span><br>        datasource.setInitialSize(initialSize);<br>        datasource.setMinIdle(minIdle);<br>        datasource.setMaxActive(maxActive);<br>        datasource.setMaxWait(maxWait);<br>        datasource.setTimeBetweenEvictionRunsMillis(timeBetweenEvictionRunsMillis);<br>        datasource.setMinEvictableIdleTimeMillis(minEvictableIdleTimeMillis);<br>        datasource.setValidationQuery(validationQuery);<br>        datasource.setTestWhileIdle(testWhileIdle);<br>        datasource.setTestOnBorrow(testOnBorrow);<br>        datasource.setTestOnReturn(testOnReturn);<br>        datasource.setPoolPreparedStatements(poolPreparedStatements);<br>        datasource.setMaxPoolPreparedStatementPerConnectionSize(maxPoolPreparedStatementPerConnectionSize);<br>        <span class=\"hljs-keyword\">try</span> &#123;<br>            datasource.setFilters(filters);<br>        &#125; <span class=\"hljs-keyword\">catch</span> (SQLException e) &#123;<br>            logger.error(<span class=\"hljs-string\">\"druid configuration initialization filter\"</span>, e);<br>        &#125;<br>        datasource.setConnectionProperties(connectionProperties);<br><br>        <span class=\"hljs-keyword\">return</span> datasource;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n\n<h3 id=\"创建数据库和数据表\"><a href=\"#创建数据库和数据表\" class=\"headerlink\" title=\"创建数据库和数据表\"></a>创建数据库和数据表</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">DATABASE</span> mytest;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> t_user(<br>  userId <span class=\"hljs-built_in\">INT</span> <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> PRIMARY <span class=\"hljs-keyword\">KEY</span> AUTO_INCREMENT,<br>  userName <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> ,<br>  <span class=\"hljs-keyword\">password</span> <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span> ,<br>  phone <span class=\"hljs-built_in\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-literal\">NULL</span><br>) <span class=\"hljs-keyword\">ENGINE</span>=<span class=\"hljs-keyword\">INNODB</span> AUTO_INCREMENT=<span class=\"hljs-number\">1000</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">CHARSET</span>=utf8;<br></code></pre></td></tr></table></figure>\n\n<h3 id=\"创建实体类：UserDomain-java\"><a href=\"#创建实体类：UserDomain-java\" class=\"headerlink\" title=\"创建实体类：UserDomain.java\"></a>创建实体类：<code>UserDomain.java</code></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.model;<br><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserDomain</span> </span>&#123;<br>    <span class=\"hljs-keyword\">private</span> Integer userId;<br><br>    <span class=\"hljs-keyword\">private</span> String userName;<br><br>    <span class=\"hljs-keyword\">private</span> String password;<br><br>    <span class=\"hljs-keyword\">private</span> String phone;<br><br>    <span class=\"hljs-comment\">// get,set方法略...</span><br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n<h3 id=\"创建dao：\"><a href=\"#创建dao：\" class=\"headerlink\" title=\"创建dao：\"></a>创建dao：</h3><p><code>UserDao.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.dao;<br><br><br><br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><span class=\"hljs-keyword\">import</span> org.apache.ibatis.annotations.Mapper;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">UserDao</span> </span>&#123;<br><br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">insert</span><span class=\"hljs-params\">(UserDomain record)</span></span>;<br><br><br><br>    <span class=\"hljs-function\">List&lt;UserDomain&gt; <span class=\"hljs-title\">selectUsers</span><span class=\"hljs-params\">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n<h3 id=\"创建mybatis映射文件：-UserMapper-xml\"><a href=\"#创建mybatis映射文件：-UserMapper-xml\" class=\"headerlink\" title=\"创建mybatis映射文件： UserMapper.xml\"></a>创建mybatis映射文件： <code>UserMapper.xml</code></h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-meta-keyword\">mapper</span> <span class=\"hljs-meta-keyword\">PUBLIC</span> <span class=\"hljs-meta-string\">\"-//mybatis.org//DTD Mapper 3.0//EN\"</span> <span class=\"hljs-meta-string\">\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"</span> &gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">mapper</span> <span class=\"hljs-attr\">namespace</span>=<span class=\"hljs-string\">\"com.winterchen.dao.UserDao\"</span> &gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sql</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>&gt;</span><br>    t_user<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sql</span>&gt;</span><br><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">sql</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"BASE_COLUMN\"</span>&gt;</span><br>    userId,userName,password,phone<br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">sql</span>&gt;</span><br><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">insert</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"insert\"</span> <span class=\"hljs-attr\">parameterType</span>=<span class=\"hljs-string\">\"com.winterchen.model.UserDomain\"</span>&gt;</span><br>    INSERT INTO<br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>/&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">trim</span> <span class=\"hljs-attr\">prefix</span>=<span class=\"hljs-string\">\"(\"</span> <span class=\"hljs-attr\">suffix</span>=<span class=\"hljs-string\">\")\"</span> <span class=\"hljs-attr\">suffixOverrides</span>=<span class=\"hljs-string\">\",\"</span>&gt;</span><br>      userName,password,<br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span>&gt;</span><br>        phone,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">trim</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">trim</span> <span class=\"hljs-attr\">prefix</span>=<span class=\"hljs-string\">\"VALUES(\"</span> <span class=\"hljs-attr\">suffix</span>=<span class=\"hljs-string\">\")\"</span> <span class=\"hljs-attr\">suffixOverrides</span>=<span class=\"hljs-string\">\",\"</span>&gt;</span><br>      #&#123;userName, jdbcType=VARCHAR&#125;,#&#123;password, jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">if</span> <span class=\"hljs-attr\">test</span>=<span class=\"hljs-string\">\"phone != null\"</span>&gt;</span><br>        #&#123;phone, jdbcType=VARCHAR&#125;,<br>      <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">if</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">trim</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">insert</span>&gt;</span><br><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">select</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">\"selectUsers\"</span> <span class=\"hljs-attr\">resultType</span>=<span class=\"hljs-string\">\"com.winterchen.model.UserDomain\"</span>&gt;</span><br>      SELECT<br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_COLUMN\"</span>/&gt;</span><br>      FROM<br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">include</span> <span class=\"hljs-attr\">refid</span>=<span class=\"hljs-string\">\"BASE_TABLE\"</span>/&gt;</span><br>  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">select</span>&gt;</span><br><br><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<h3 id=\"创建剩余的controller，service包和文件\"><a href=\"#创建剩余的controller，service包和文件\" class=\"headerlink\" title=\"创建剩余的controller，service包和文件\"></a>创建剩余的<code>controller</code>，<code>service</code>包和文件</h3><p><code>UserService.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.service.user;<br><br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2018/4/19.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">UserService</span> </span>&#123;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">addUser</span><span class=\"hljs-params\">(UserDomain user)</span></span>;<br><br>    <span class=\"hljs-function\">List&lt;UserDomain&gt; <span class=\"hljs-title\">findAllUser</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> pageNum, <span class=\"hljs-keyword\">int</span> pageSize)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p><code>UserServiceImpl</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.service.user.impl;<br><br><span class=\"hljs-keyword\">import</span> com.github.pagehelper.PageHelper;<br><span class=\"hljs-keyword\">import</span> com.winterchen.dao.UserDao;<br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><span class=\"hljs-keyword\">import</span> com.winterchen.service.user.UserService;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.stereotype.Service;<br><br><span class=\"hljs-keyword\">import</span> java.util.List;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2017/8/16.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Service</span>(value = <span class=\"hljs-string\">\"userService\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserServiceImpl</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">UserService</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> UserDao userDao;<span class=\"hljs-comment\">//这里会报错，但是并不会影响</span><br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">addUser</span><span class=\"hljs-params\">(UserDomain user)</span> </span>&#123;<br><br>        <span class=\"hljs-keyword\">return</span> userDao.insert(user);<br>    &#125;<br><br>    <span class=\"hljs-comment\">/*</span><br><span class=\"hljs-comment\">    * 这个方法中用到了我们开头配置依赖的分页插件pagehelper</span><br><span class=\"hljs-comment\">    * 很简单，只需要在service层传入参数，然后将参数传递给一个插件的一个静态方法即可；</span><br><span class=\"hljs-comment\">    * pageNum 开始页数</span><br><span class=\"hljs-comment\">    * pageSize 每页显示的数据条数</span><br><span class=\"hljs-comment\">    * */</span><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> List&lt;UserDomain&gt; <span class=\"hljs-title\">findAllUser</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> pageNum, <span class=\"hljs-keyword\">int</span> pageSize)</span> </span>&#123;<br>        <span class=\"hljs-comment\">//将参数传给这个方法就可以实现物理分页了，非常简单。</span><br>        PageHelper.startPage(pageNum, pageSize);<br>        <span class=\"hljs-keyword\">return</span> userDao.selectUsers();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p><code>UserController.java</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">package</span> com.winterchen.controller;<br><br><span class=\"hljs-keyword\">import</span> com.github.pagehelper.PageHelper;<br><span class=\"hljs-keyword\">import</span> com.winterchen.model.UserDomain;<br><span class=\"hljs-keyword\">import</span> com.winterchen.service.user.UserService;<br><span class=\"hljs-keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class=\"hljs-keyword\">import</span> org.springframework.stereotype.Controller;<br><span class=\"hljs-keyword\">import</span> org.springframework.web.bind.annotation.*;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * Created by Administrator on 2017/8/16.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Controller</span><br><span class=\"hljs-meta\">@RequestMapping</span>(value = <span class=\"hljs-string\">\"/user\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">UserController</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> UserService userService;<br><br>    <span class=\"hljs-meta\">@ResponseBody</span><br>    <span class=\"hljs-meta\">@PostMapping</span>(<span class=\"hljs-string\">\"/add\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">addUser</span><span class=\"hljs-params\">(UserDomain user)</span></span>&#123;<br>        <span class=\"hljs-keyword\">return</span> userService.addUser(user);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@ResponseBody</span><br>    <span class=\"hljs-meta\">@GetMapping</span>(<span class=\"hljs-string\">\"/all\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title\">findAllUser</span><span class=\"hljs-params\">(</span></span><br><span class=\"hljs-function\"><span class=\"hljs-params\">            @RequestParam(name = <span class=\"hljs-string\">\"pageNum\"</span>, required = <span class=\"hljs-keyword\">false</span>, defaultValue = <span class=\"hljs-string\">\"1\"</span>)</span></span><br><span class=\"hljs-function\">                    <span class=\"hljs-keyword\">int</span> pageNum,</span><br><span class=\"hljs-function\">            @<span class=\"hljs-title\">RequestParam</span><span class=\"hljs-params\">(name = <span class=\"hljs-string\">\"pageSize\"</span>, required = <span class=\"hljs-keyword\">false</span>, defaultValue = <span class=\"hljs-string\">\"10\"</span>)</span></span><br><span class=\"hljs-function\">                    <span class=\"hljs-keyword\">int</span> pageSize)</span>&#123;<br>        <span class=\"hljs-comment\">//开始分页</span><br>        PageHelper.startPage(pageNum,pageSize);<br>        <span class=\"hljs-keyword\">return</span> userService.findAllUser(pageNum,pageSize);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"项目最终的结构\"><a href=\"#项目最终的结构\" class=\"headerlink\" title=\"项目最终的结构\"></a>项目最终的结构</h2><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046467097250.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">项目结构</span></p>\n<blockquote>\n<p>到这里如果项目就成功搭建完成了，如果还是报错的话，请仔细看看配置，后面会给出源码地址，程序员就是要不断和bug进行斗争，加油。</p>\n</blockquote>\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>启动项目</p>\n<p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046467147252.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">启动项目</span></p>\n<p>这样就表示启动成功了</p>\n<p>然后，开始测试吧，博主使用的是postMan，一个进行http请求的测试工具</p>\n<h3 id=\"添加数据\"><a href=\"#添加数据\" class=\"headerlink\" title=\"添加数据\"></a>添加数据</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046467254251.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">添加数据</span></p>\n<h3 id=\"查询数据\"><a href=\"#查询数据\" class=\"headerlink\" title=\"查询数据\"></a>查询数据</h3><p><img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046467296252.png\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"   ><span class=\"image-caption\">查询数据</span></p>\n<p>源码地址：</p>\n<p><a href=\"https://github.com/WinterChenS/springboot2-mybatis-demo\" target=\"_blank\" rel=\"noopener\">https://github.com/WinterChenS/springboot2-mybatis-demo</a></p>\n<p>如果遇到问题可以加我wechat：</p>\n<img    class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046784292084.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  width = \"200\" height = \"200\"  /><span class=\"image-caption\">wechat</span>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","raw":null,"categories":[{"name":"Spring Boot","path":"api/categories/Spring Boot.json"}],"tags":[{"name":"Spring Boot","path":"api/tags/Spring Boot.json"},{"name":"mybatis","path":"api/tags/mybatis.json"}]}]}