{"name":"spring","postlist":[{"title":"spring中添加自定义的拦截器","slug":"my-spring-interceptor","date":"2018-05-09T08:48:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/my-spring-interceptor.json","excerpt":" [Figure] 要想实现自定义的拦截器，我们不得不讲讲spring中的处理程序拦截器，那么什么是处理程序拦截器呢？","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://images.unsplash.com/photo-1522199794616-8a62b541f762?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=71b5877630deb9ab5996f91cc61b43f7&auto=format&fit=crop&w=2104&q=80","content":"<p><img   class=\"lazyload\" data-original=\"https://images.unsplash.com/photo-1522199794616-8a62b541f762?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=71b5877630deb9ab5996f91cc61b43f7&auto=format&fit=crop&w=2104&q=80\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p>要想实现自定义的拦截器，我们不得不讲讲spring中的处理程序拦截器，那么什么是处理程序拦截器呢？</p>\n<a id=\"more\"></a>\n\n<h2 id=\"什么是spring中的处理程序拦截器？\"><a href=\"#什么是spring中的处理程序拦截器？\" class=\"headerlink\" title=\"什么是spring中的处理程序拦截器？\"></a>什么是spring中的处理程序拦截器？</h2><p>要想了解拦截器在spring中的作用，我们首先要了解一下HTTP的请求执行链。</p>\n<ol>\n<li><p>DispatcherServlet捕获每一个请求；</p>\n</li>\n<li><p>DispatcherServlet将接收到的URL和相应的Controller进行映射；</p>\n</li>\n<li><p>在请求到达相应的Controller之前<strong>拦截器</strong>会进行请求处理；</p>\n</li>\n<li><p>处理完成之后进行视图的解析；</p>\n</li>\n<li><p>返回视图。</p>\n</li>\n</ol>\n<p>在第3步中，也就是今天最重要的内容，在请求到达Controller之前，请求可以被拦截器处理，这些拦截器就像过滤器。只有当URL找到对应于它们的处理器时才会调用它们。在通过拦截器(拦截器预处理，其实也可以说前置处理)进行前置处理后，请求最终到达controller。之后，发送请求生成视图。但是在这之前，拦截器还是有可能来再次处理它(拦截器后置处理)。只有在最后一次操作之后，视图解析器才能捕获数据并输出视图。</p>\n<p>处理程序映射拦截器基于<code>org.springframework.web.servlet.HandlerInterceptor</code>接口。这个接口有三个方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">HandlerInterceptor</span> </span>&#123;<br><br>  <span class=\"hljs-comment\">//请求发送到Controller之前调用</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">boolean</span> <span class=\"hljs-title\">preHandle</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span><br><span class=\"hljs-function\">            <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br><br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">true</span>;<br>    &#125;<br><br>    <span class=\"hljs-comment\">//请求发送到Controller之后调用</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">postHandle</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, Object handler,</span></span><br><span class=\"hljs-function\"><span class=\"hljs-params\">            @Nullable ModelAndView modelAndView)</span> <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>    &#125;<br><br>    <span class=\"hljs-comment\">//完成请求的处理的回调方法</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">afterCompletion</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, Object handler,</span></span><br><span class=\"hljs-function\"><span class=\"hljs-params\">            @Nullable Exception ex)</span> <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n<h2 id=\"编写自定义的拦截器\"><a href=\"#编写自定义的拦截器\" class=\"headerlink\" title=\"编写自定义的拦截器\"></a>编写自定义的拦截器</h2><p>要想编写自定义的拦截器，需要有两个步骤：</p>\n<ul>\n<li><p>实现<code>HandlerInterceptor</code>接口和方法；</p>\n</li>\n<li><p>将自定义拦截器添加到MVC中。</p>\n</li>\n</ul>\n<p>下面我们来实现一下代码：</p>\n<h3 id=\"首先我们创建一个类BaseInterceptor\"><a href=\"#首先我们创建一个类BaseInterceptor\" class=\"headerlink\" title=\"首先我们创建一个类BaseInterceptor\"></a>首先我们创建一个类<code>BaseInterceptor</code></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 实现HandlerInterceptor接口，自定义拦截器</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">BaseInterceptor</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">HandlerInterceptor</span> </span>&#123;<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> Logger LOGGE = LoggerFactory.getLogger(BaseInterceptor<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;<br><br>      <span class=\"hljs-comment\">//实现前置方法</span><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">boolean</span> <span class=\"hljs-title\">preHandle</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, Object o)</span> <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>        String uri = request.getRequestURI();<br><br>        LOGGE.info(<span class=\"hljs-string\">\"UserAgent: &#123;&#125;\"</span>, request.getHeader(USER_AGENT));<br>        LOGGE.info(<span class=\"hljs-string\">\"用户访问地址: &#123;&#125;, 来路地址: &#123;&#125;\"</span>, uri, IPKit.getIpAddrByRequest(request));<br><br><br>      <span class=\"hljs-comment\">//拦截器处理用户权限</span><br>        <span class=\"hljs-keyword\">if</span> (uri.startsWith(<span class=\"hljs-string\">\"/admin\"</span>) &amp;&amp; !uri.startsWith(<span class=\"hljs-string\">\"/admin/login\"</span>)) &#123;<br>            response.sendRedirect(request.getContextPath() + <span class=\"hljs-string\">\"/admin/login\"</span>);<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">false</span>;<br>        &#125;<br><br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">true</span>;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">postHandle</span><span class=\"hljs-params\">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView)</span> <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>        <span class=\"hljs-comment\">//这个方法可以往request中添加一些公共的工具类给前端页面进行调用</span><br><br>    &#125;<br><br><br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">afterCompletion</span><span class=\"hljs-params\">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e)</span> <span class=\"hljs-keyword\">throws</span> Exception </span>&#123;<br>        <span class=\"hljs-comment\">//当请求处理完成调用</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>以上的自定义拦截器实现类中，我们实现了<code>HandlerInterceptor</code>接口，并且实现了三个方法：<code>preHandle</code>、<code>postHandle</code>、<code>afterCompletion</code>。</p>\n<p>在实际的应用中呢，我们常常可以在请求处理的前置方法<code>preHandle</code>中进行权限的验证，<code>postHandle</code>后置方法在实际的使用当中可以往request中添加一些公共的工具类给前端页面进行调用。</p>\n<h3 id=\"创建一个类WebMvcConfig实现WebMvcConfigurer接口\"><a href=\"#创建一个类WebMvcConfig实现WebMvcConfigurer接口\" class=\"headerlink\" title=\"创建一个类WebMvcConfig实现WebMvcConfigurer接口\"></a>创建一个类<code>WebMvcConfig</code>实现<code>WebMvcConfigurer</code>接口</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 向MVC中添加自定义组件</span><br><span class=\"hljs-comment\"> * Created by Donghua.Chen on 2018/4/30.</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">WebMvcConfig</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">WebMvcConfigurer</span> </span>&#123;<br><br>    <span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> BaseInterceptor baseInterceptor;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">addInterceptors</span><span class=\"hljs-params\">(InterceptorRegistry registry)</span> </span>&#123;<br>        registry.addInterceptor(baseInterceptor);<br>    &#125;<br><br><br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>这个类的主要作用就是将我们刚才自定义的拦截器组件添加到MVC中去。</p>\n<p>以上我们就完成了自定义拦截器的全部过程，是不是很简单呢？</p>\n","raw":null,"categories":[{"name":"spring","path":"api/categories/spring.json"}],"tags":[{"name":"spring","path":"api/tags/spring.json"}]},{"title":"当springMVC上下文尚未初始化的时候如何@Autowired注入对象呢？","slug":"spring-autowired","date":"2018-05-30T01:45:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/spring-autowired.json","excerpt":" [Figure] 一个问题困扰了我一天，场景是这样的：公司有一个独立的SSO用户权限验证中心，我负责的是公司的一个其他的独立项目；每次用户session过期或者未登录的时候跳统一登录页面；用户成功登录之后都会回调，回调的信息中有用户的userAccount；此时需要根据用户的userAccount获取用户的详细信息；权限系统提供了一个获取用户的接口；","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046776553776.jpg","content":"<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046776701619.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p>一个问题困扰了我一天，场景是这样的：</p>\n<ul>\n<li>公司有一个独立的SSO用户权限验证中心，我负责的是公司的一个其他的独立项目；</li>\n<li>每次用户session过期或者未登录的时候跳统一登录页面；</li>\n<li>用户成功登录之后都会回调，回调的信息中有用户的userAccount；</li>\n<li>此时需要根据用户的userAccount获取用户的详细信息；</li>\n<li>权限系统提供了一个获取用户的接口；<a id=\"more\"></a>\n\n</li>\n</ul>\n<p>遇到的问题：</p>\n<ul>\n<li>使用的是shrio进行系统权限的控制，当用户在SSO登录页面成功登录之后会回调到shrio的配置类中；</li>\n<li>需要在shrio的配置类中调用根据用户账号获取用户信息的接口：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">IecWepmShiroAuthService</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">AbstractShiroAuthService</span>&lt;<span class=\"hljs-title\">SessionUser</span>&gt; <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">EnvironmentAware</span> </span>&#123;<br><br>\t<span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> TenantUserCloudService tenantUserCloudService;<br>&#125;<br>```\t<br><br>调用的就是这么一个接口<br><br>```java<br><span class=\"hljs-meta\">@CloudServiceClient</span>(<span class=\"hljs-string\">\"gap-service-tenant-auth\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title\">TenantUserCloudService</span> </span>&#123;<br><br>\t<span class=\"hljs-meta\">@RequestMapping</span>(<br>        value = &#123;<span class=\"hljs-string\">\"/tenant/user/by-emp-no\"</span>&#125;,<br>        method = &#123;RequestMethod.GET&#125;<br>    )<br>    <span class=\"hljs-function\">APIResponse&lt;TenantUser&gt; <span class=\"hljs-title\">getTenantUserByEmpNo</span><span class=\"hljs-params\">(@RequestParam(name = <span class=\"hljs-string\">\"tenantId\"</span>,required = <span class=\"hljs-keyword\">true</span>)</span> Integer var1, @<span class=\"hljs-title\">RequestParam</span><span class=\"hljs-params\">(name = <span class=\"hljs-string\">\"empNo\"</span>,required = <span class=\"hljs-keyword\">true</span>)</span> String var2)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>如果按照下面的代码进行注入，那么由于shrio的初始化要先与springMVC，所以导致找不到相关处理的类；</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><br><span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-keyword\">private</span> TenantUserCloudService tenantUserCloudService;<br></code></pre></td></tr></table></figure>\n\n<p>解决的思路就是：</p>\n<ul>\n<li>首先不进行<code>tenantUserCloudService</code>的初始化，只有在调用该接口的时候进行初始化；</li>\n<li>创建一个类实现<code>ApplicationContextAware</code>接口，实现这个接口可以很方便的从spring容器中获取bean；</li>\n<li>机制就是<strong>当调用这个接口的时候才从spring容器中获取这个bean</strong>；</li>\n</ul>\n<p>创建一个类实现<code>ApplicationContextAware</code>接口：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">//相当于给一个bean进行代理</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">DelegateBean</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">ApplicationContextAware</span> </span>&#123;<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> Logger logger = LoggerFactory.getLogger(DelegateBean<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;<br>    <span class=\"hljs-keyword\">protected</span> ApplicationContext applicationContext;<br>    <span class=\"hljs-keyword\">protected</span> Object target;<br>    <span class=\"hljs-keyword\">protected</span> String targetBeanName;<br>    <span class=\"hljs-keyword\">protected</span> Class targetBeanType;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-title\">DelegateBean</span><span class=\"hljs-params\">(String targetBeanName)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.targetBeanName = targetBeanName;<br>    &#125;<br>\t<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-title\">DelegateBean</span><span class=\"hljs-params\">(Class targetBeanType)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.targetBeanType = targetBeanType;<br>    &#125;<br>\t<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-title\">DelegateBean</span><span class=\"hljs-params\">(ApplicationContext applicationContext, String targetBeanName)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.applicationContext = applicationContext;<br>        <span class=\"hljs-keyword\">this</span>.targetBeanName = targetBeanName;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-title\">DelegateBean</span><span class=\"hljs-params\">(ApplicationContext applicationContext, Class targetBeanType)</span> </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.applicationContext = applicationContext;<br>        <span class=\"hljs-keyword\">this</span>.targetBeanType = targetBeanType;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">setApplicationContext</span><span class=\"hljs-params\">(ApplicationContext applicationContext)</span> <span class=\"hljs-keyword\">throws</span> BeansException </span>&#123;<br>        <span class=\"hljs-keyword\">this</span>.applicationContext = applicationContext;<br>    &#125;<br>\t<span class=\"hljs-comment\">//当调用这个方法的时候才从spring容器中获取bean；</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title\">target</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        Assert.notNull(<span class=\"hljs-keyword\">this</span>.applicationContext, <span class=\"hljs-string\">\"A DelegateBean should be managed by ApplicationContext or pass ApplicationContext though constructor arg\"</span>);<br>        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-keyword\">this</span>.target == <span class=\"hljs-keyword\">null</span>) &#123;<br>            <span class=\"hljs-keyword\">synchronized</span>(<span class=\"hljs-keyword\">this</span>) &#123;<br>                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">this</span>.target != <span class=\"hljs-keyword\">null</span>?<span class=\"hljs-keyword\">this</span>.target:(<span class=\"hljs-keyword\">this</span>.target = <span class=\"hljs-keyword\">this</span>.doGetBeanFromApplicationContext());<br>            &#125;<br>        &#125; <span class=\"hljs-keyword\">else</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">this</span>.target;<br>        &#125;<br>    &#125;<br><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">protected</span> Object <span class=\"hljs-title\">doGetBeanFromApplicationContext</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">this</span>.targetBeanName != <span class=\"hljs-keyword\">null</span>?<span class=\"hljs-keyword\">this</span>.applicationContext.getBean(<span class=\"hljs-keyword\">this</span>.targetBeanName):(<span class=\"hljs-keyword\">this</span>.targetBeanType != <span class=\"hljs-keyword\">null</span>?<span class=\"hljs-keyword\">this</span>.applicationContext.getBean(<span class=\"hljs-keyword\">this</span>.targetBeanType):<span class=\"hljs-keyword\">null</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>只是这样配置还是不够的，我们需要在spring初始化的时候将这个代理bean交给spring容器进行管理；</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">IecWepmAutoConfiguration</span></span>&#123;<br><br>\t<span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-meta\">@Qualifier</span>(<span class=\"hljs-string\">\"tenantUserCloudService\"</span>)<br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> DelegateBean <span class=\"hljs-title\">tenantUserCloudService</span><span class=\"hljs-params\">()</span></span>&#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> DelegateBean(TenantUserCloudService<span class=\"hljs-class\">.<span class=\"hljs-keyword\">class</span>)</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n<p>然后再shrio的类中我们需要进行这样的使用：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">IecWepmShiroAuthService</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title\">AbstractShiroAuthService</span>&lt;<span class=\"hljs-title\">SessionUser</span>&gt; <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title\">EnvironmentAware</span> </span>&#123;<br>\t<span class=\"hljs-meta\">@Autowired</span><br>    <span class=\"hljs-meta\">@Qualifier</span>(<span class=\"hljs-string\">\"tenantUserCloudService\"</span>)<br>    <span class=\"hljs-keyword\">private</span> DelegateBean tenantUserCloudService;<br>\t<br>\t<span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> SessionUser <span class=\"hljs-title\">doLogin</span><span class=\"hljs-params\">(String userAccount, String userPwd)</span> </span>&#123;<br>        <br>        <span class=\"hljs-comment\">//根据用户编号获取用户信息,调用target()是关键，只有在调用这个方法的时候才会从spring容器中获取信息</span><br>        APIResponse&lt;TenantUser&gt; tenantUserByEmpNo = ((TenantUserCloudService) tenantUserCloudService.target())<br>                .getTenantUserByEmpNo(TENANT_ID, userAccount);<br>        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-string\">\"success\"</span>.equals(tenantUserByEmpNo.getCode()) &amp;&amp; <span class=\"hljs-keyword\">null</span> != tenantUserByEmpNo.getData())&#123;<br>            userAccount = tenantUserByEmpNo.getData().getDomainAccountList().get(<span class=\"hljs-number\">0</span>).getDomainAccount();<br>        &#125;<br>        UserInfoDto userInfo = userService.getUserByAccount(userAccount);<br>        SessionUser sessionUser = <span class=\"hljs-keyword\">new</span> SessionUser();<br>        sessionUser.setUserId(Integer.valueOf(userAccount));<br>        AuthUtils.setSessionUser(sessionUser);<br>        <span class=\"hljs-comment\">// todo 返回的SessionUser 就是保存在session里的对象 通过 SessionUser sessionUser = (SessionUser) AuthUtils.getSessionUser(); 进行获取</span><br>        <span class=\"hljs-keyword\">return</span> sessionUser;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n<p>关键： <strong>以上的思路最主要的就是，在shrio初始化的时候仅仅只是初始化一个空壳，只有当使用那个bean的时候才从spring容器中获取bean并且注入，这样的好处就是当当前bean的声明周期还未开始的时候预留一个位置，当使用的时候才从spring容器中注入，这样不会导致项目启动的时候就会找不到bean</strong>；</p>\n","raw":null,"categories":[{"name":"spring","path":"api/categories/spring.json"}],"tags":[{"name":"spring","path":"api/tags/spring.json"}]},{"title":"springboot 中 @ConditionalOnExpression注解 在特定情况下使用相关配置或者实例化bean","slug":"spring-boot-conditional-on-expression","date":"2018-05-30T01:20:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/spring-boot-conditional-on-expression.json","excerpt":" [Figure] 在开发中会遇到一些需求：在配置文件中设置一个enable，当这个配置为true的时候，才进行相关的配置类的初始化。","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046777237348.jpg","content":"<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046777524470.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"></p>\n<p>在开发中会遇到一些需求：在配置文件中设置一个enable，当这个配置为true的时候，才进行相关的配置类的初始化。</p>\n<a id=\"more\"></a>\n\n\n<p>示例：</p>\n<p>需要实例化的bean，请不要加@Component注解</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">TestBean</span> </span>&#123;<br>  <br>  <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-title\">TestBean</span><span class=\"hljs-params\">()</span></span>&#123;<br>    <br>  &#125;<br>  <br>  <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-title\">doSomeThing</span><span class=\"hljs-params\">()</span></span>&#123;<br>    <br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n<p>配置类：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-meta\">@ConditionalOnExpression</span>(<span class=\"hljs-string\">\"$&#123;test.enabled:true&#125;\"</span>)<br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">TestConfiguration</span> </span>&#123;<br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> TestBean <span class=\"hljs-title\">testBean</span><span class=\"hljs-params\">()</span> </span>&#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> TestBean();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n\n\n\n<p>配置文件：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">test.enabled:</span> <span class=\"hljs-literal\">true</span><br></code></pre></td></tr></table></figure>\n\n<p>这个bean只有在<code>test.enabled: true</code>的时候才会进行初始化。</p>\n","raw":null,"categories":[{"name":"spring","path":"api/categories/spring.json"}],"tags":[{"name":"spring","path":"api/tags/spring.json"}]},{"title":"Spring中使用log4j详细配置","slug":"spring-log4j","date":"2017-09-26T08:39:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"top":null,"path":"api/articles/spring-log4j.json","excerpt":" [Figure]     log4j.properties的详细配置：","keywords":"java,spring,springboot,springcloud,mybatis,jQuery,html,css","cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046779668417.jpg","content":"<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046780016875.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"><br>第一步：导入log4j-1.2.17.jar包。<br>第二步：src同级创建并设置log4j.properties。<br>    log4j.properties的详细配置：</p>\n<a id=\"more\"></a>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs properties\"><span class=\"hljs-comment\"> ### 设置 ###</span><br><span class=\"hljs-meta\">log4j.rootLogger</span> = <span class=\"hljs-string\">debug,stdout,D,E</span><br><br><span class=\"hljs-comment\">### 输出信息到控制抬 ###</span><br><span class=\"hljs-meta\">log4j.appender.stdout</span> = <span class=\"hljs-string\">org.apache.log4j.ConsoleAppender</span><br><span class=\"hljs-meta\">log4j.appender.stdout.Target</span> = <span class=\"hljs-string\">System.out</span><br><span class=\"hljs-meta\">log4j.appender.stdout.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.stdout.layout.ConversionPattern</span> = <span class=\"hljs-string\">[%-5p] %d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; method:%l%n%m%n</span><br><br><span class=\"hljs-comment\">### 输出DEBUG 级别以上的日志到=E://logs/error.log ###</span><br><span class=\"hljs-meta\">log4j.appender.D</span> = <span class=\"hljs-string\">org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"hljs-meta\">log4j.appender.D.File</span> = <span class=\"hljs-string\">E://logs/log.log</span><br><span class=\"hljs-meta\">log4j.appender.D.Append</span> = <span class=\"hljs-string\">true</span><br><span class=\"hljs-meta\">log4j.appender.D.Threshold</span> = <span class=\"hljs-string\">DEBUG </span><br><span class=\"hljs-meta\">log4j.appender.D.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.D.layout.ConversionPattern</span> = <span class=\"hljs-string\">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span><br><br><span class=\"hljs-comment\">### 输出ERROR 级别以上的日志到=E://logs/error.log ###</span><br><span class=\"hljs-meta\">log4j.appender.E</span> = <span class=\"hljs-string\">org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"hljs-meta\">log4j.appender.E.File</span> =<span class=\"hljs-string\">E://logs/error.log </span><br><span class=\"hljs-meta\">log4j.appender.E.Append</span> = <span class=\"hljs-string\">true</span><br><span class=\"hljs-meta\">log4j.appender.E.Threshold</span> = <span class=\"hljs-string\">ERROR </span><br><span class=\"hljs-meta\">log4j.appender.E.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.E.layout.ConversionPattern</span> = <span class=\"hljs-string\">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span><br></code></pre></td></tr></table></figure>\n\n<p><a href=\"http://blog.csdn.net/qq_30175203/article/details/52084127\" target=\"_blank\" rel=\"noopener\">更详细的log4j.properties配置</a></p>\n<p>第三步：web.xml中加入配置详细：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-comment\">&lt;!-- 设置根目录 --&gt;</span>  <br><span class=\"hljs-comment\">&lt;!--初始化log4j.properties--&gt;</span><br>   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">context-param</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-name</span>&gt;</span>log4jConfigLocation<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-name</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-value</span>&gt;</span>/WEB-INF/classes/log4j.properties<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-value</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">context-param</span>&gt;</span>  <br><span class=\"hljs-comment\">&lt;!-- 3000表示 开一条watchdog线程每60秒扫描一下配置文件的变化;这样便于日志存放位置的改变 --&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">context-param</span>&gt;</span>    <br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-name</span>&gt;</span>log4jRefreshInterval<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-name</span>&gt;</span>    <br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-value</span>&gt;</span>3000<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-value</span>&gt;</span>    <br>   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">context-param</span>&gt;</span>   <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">listener</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">listener-class</span>&gt;</span>org.springframework.web.util.Log4jConfigListener<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">listener-class</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">listener</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n\n<p>applicationContext.xml就不需要配置了</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">beans</span> <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/beans\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xmlns:xsi</span>=<span class=\"hljs-string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span> <span class=\"hljs-attr\">xmlns:context</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/context\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xmlns:aop</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/aop\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xsi:schemaLocation</span>=<span class=\"hljs-string\">\"    </span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/beans</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/aop</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/aop/spring-aop-3.2.xsd</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/context</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">           http://www.springframework.org/schema/context/spring-context-3.2.xsd\"</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>然后日志就可以随着spring的启动而启动了。</p>\n<p>如果想把日志文件打印到Tomcat日志文件中：<br>log4j.appender.R.File=${catalina.home}/logs/youLogFile.log </p>\n<p>这个方法只能Tomcat使用，其它容器就不行了。</p>\n","raw":null,"categories":[{"name":"spring","path":"api/categories/spring.json"}],"tags":[{"name":"spring","path":"api/tags/spring.json"},{"name":"log4j","path":"api/tags/log4j.json"}]}]}