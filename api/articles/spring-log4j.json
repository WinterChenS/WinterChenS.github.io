{"title":"Spring中使用log4j详细配置","slug":"spring-log4j","date":"2017-09-26T08:39:00.000Z","updated":"2022-12-01T01:32:39.787Z","comments":true,"path":"api/articles/spring-log4j.json","excerpt":" [Figure]     log4j.properties的详细配置：","covers":["data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="],"cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046779668417.jpg","content":"<p><img   class=\"lazyload\" data-original=\"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046780016875.jpg\" src=\"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==\"  alt=\"\"><br>第一步：导入log4j-1.2.17.jar包。<br>第二步：src同级创建并设置log4j.properties。<br>    log4j.properties的详细配置：</p>\n<a id=\"more\"></a>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs properties\"><span class=\"hljs-comment\"> ### 设置 ###</span><br><span class=\"hljs-meta\">log4j.rootLogger</span> = <span class=\"hljs-string\">debug,stdout,D,E</span><br><br><span class=\"hljs-comment\">### 输出信息到控制抬 ###</span><br><span class=\"hljs-meta\">log4j.appender.stdout</span> = <span class=\"hljs-string\">org.apache.log4j.ConsoleAppender</span><br><span class=\"hljs-meta\">log4j.appender.stdout.Target</span> = <span class=\"hljs-string\">System.out</span><br><span class=\"hljs-meta\">log4j.appender.stdout.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.stdout.layout.ConversionPattern</span> = <span class=\"hljs-string\">[%-5p] %d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; method:%l%n%m%n</span><br><br><span class=\"hljs-comment\">### 输出DEBUG 级别以上的日志到=E://logs/error.log ###</span><br><span class=\"hljs-meta\">log4j.appender.D</span> = <span class=\"hljs-string\">org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"hljs-meta\">log4j.appender.D.File</span> = <span class=\"hljs-string\">E://logs/log.log</span><br><span class=\"hljs-meta\">log4j.appender.D.Append</span> = <span class=\"hljs-string\">true</span><br><span class=\"hljs-meta\">log4j.appender.D.Threshold</span> = <span class=\"hljs-string\">DEBUG </span><br><span class=\"hljs-meta\">log4j.appender.D.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.D.layout.ConversionPattern</span> = <span class=\"hljs-string\">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span><br><br><span class=\"hljs-comment\">### 输出ERROR 级别以上的日志到=E://logs/error.log ###</span><br><span class=\"hljs-meta\">log4j.appender.E</span> = <span class=\"hljs-string\">org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"hljs-meta\">log4j.appender.E.File</span> =<span class=\"hljs-string\">E://logs/error.log </span><br><span class=\"hljs-meta\">log4j.appender.E.Append</span> = <span class=\"hljs-string\">true</span><br><span class=\"hljs-meta\">log4j.appender.E.Threshold</span> = <span class=\"hljs-string\">ERROR </span><br><span class=\"hljs-meta\">log4j.appender.E.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.E.layout.ConversionPattern</span> = <span class=\"hljs-string\">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span><br></code></pre></td></tr></table></figure>\n\n<p><a href=\"http://blog.csdn.net/qq_30175203/article/details/52084127\" target=\"_blank\" rel=\"noopener\">更详细的log4j.properties配置</a></p>\n<p>第三步：web.xml中加入配置详细：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-comment\">&lt;!-- 设置根目录 --&gt;</span>  <br><span class=\"hljs-comment\">&lt;!--初始化log4j.properties--&gt;</span><br>   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">context-param</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-name</span>&gt;</span>log4jConfigLocation<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-name</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-value</span>&gt;</span>/WEB-INF/classes/log4j.properties<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-value</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">context-param</span>&gt;</span>  <br><span class=\"hljs-comment\">&lt;!-- 3000表示 开一条watchdog线程每60秒扫描一下配置文件的变化;这样便于日志存放位置的改变 --&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">context-param</span>&gt;</span>    <br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-name</span>&gt;</span>log4jRefreshInterval<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-name</span>&gt;</span>    <br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-value</span>&gt;</span>3000<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-value</span>&gt;</span>    <br>   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">context-param</span>&gt;</span>   <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">listener</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">listener-class</span>&gt;</span>org.springframework.web.util.Log4jConfigListener<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">listener-class</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">listener</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n\n<p>applicationContext.xml就不需要配置了</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">beans</span> <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/beans\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xmlns:xsi</span>=<span class=\"hljs-string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span> <span class=\"hljs-attr\">xmlns:context</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/context\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xmlns:aop</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/aop\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xsi:schemaLocation</span>=<span class=\"hljs-string\">\"    </span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/beans</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/aop</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/aop/spring-aop-3.2.xsd</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/context</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">           http://www.springframework.org/schema/context/spring-context-3.2.xsd\"</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>然后日志就可以随着spring的启动而启动了。</p>\n<p>如果想把日志文件打印到Tomcat日志文件中：<br>log4j.appender.R.File=${catalina.home}/logs/youLogFile.log </p>\n<p>这个方法只能Tomcat使用，其它容器就不行了。</p>\n","more":"<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs properties\"><span class=\"hljs-comment\"> ### 设置 ###</span><br><span class=\"hljs-meta\">log4j.rootLogger</span> = <span class=\"hljs-string\">debug,stdout,D,E</span><br><br><span class=\"hljs-comment\">### 输出信息到控制抬 ###</span><br><span class=\"hljs-meta\">log4j.appender.stdout</span> = <span class=\"hljs-string\">org.apache.log4j.ConsoleAppender</span><br><span class=\"hljs-meta\">log4j.appender.stdout.Target</span> = <span class=\"hljs-string\">System.out</span><br><span class=\"hljs-meta\">log4j.appender.stdout.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.stdout.layout.ConversionPattern</span> = <span class=\"hljs-string\">[%-5p] %d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; method:%l%n%m%n</span><br><br><span class=\"hljs-comment\">### 输出DEBUG 级别以上的日志到=E://logs/error.log ###</span><br><span class=\"hljs-meta\">log4j.appender.D</span> = <span class=\"hljs-string\">org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"hljs-meta\">log4j.appender.D.File</span> = <span class=\"hljs-string\">E://logs/log.log</span><br><span class=\"hljs-meta\">log4j.appender.D.Append</span> = <span class=\"hljs-string\">true</span><br><span class=\"hljs-meta\">log4j.appender.D.Threshold</span> = <span class=\"hljs-string\">DEBUG </span><br><span class=\"hljs-meta\">log4j.appender.D.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.D.layout.ConversionPattern</span> = <span class=\"hljs-string\">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span><br><br><span class=\"hljs-comment\">### 输出ERROR 级别以上的日志到=E://logs/error.log ###</span><br><span class=\"hljs-meta\">log4j.appender.E</span> = <span class=\"hljs-string\">org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"hljs-meta\">log4j.appender.E.File</span> =<span class=\"hljs-string\">E://logs/error.log </span><br><span class=\"hljs-meta\">log4j.appender.E.Append</span> = <span class=\"hljs-string\">true</span><br><span class=\"hljs-meta\">log4j.appender.E.Threshold</span> = <span class=\"hljs-string\">ERROR </span><br><span class=\"hljs-meta\">log4j.appender.E.layout</span> = <span class=\"hljs-string\">org.apache.log4j.PatternLayout</span><br><span class=\"hljs-meta\">log4j.appender.E.layout.ConversionPattern</span> = <span class=\"hljs-string\">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</span><br></code></pre></td></tr></table></figure>\n\n<p><a href=\"http://blog.csdn.net/qq_30175203/article/details/52084127\" target=\"_blank\" rel=\"noopener\">更详细的log4j.properties配置</a></p>\n<p>第三步：web.xml中加入配置详细：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-comment\">&lt;!-- 设置根目录 --&gt;</span>  <br><span class=\"hljs-comment\">&lt;!--初始化log4j.properties--&gt;</span><br>   <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">context-param</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-name</span>&gt;</span>log4jConfigLocation<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-name</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-value</span>&gt;</span>/WEB-INF/classes/log4j.properties<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-value</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">context-param</span>&gt;</span>  <br><span class=\"hljs-comment\">&lt;!-- 3000表示 开一条watchdog线程每60秒扫描一下配置文件的变化;这样便于日志存放位置的改变 --&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">context-param</span>&gt;</span>    <br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-name</span>&gt;</span>log4jRefreshInterval<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-name</span>&gt;</span>    <br>        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">param-value</span>&gt;</span>3000<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">param-value</span>&gt;</span>    <br>   <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">context-param</span>&gt;</span>   <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">listener</span>&gt;</span>  <br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">listener-class</span>&gt;</span>org.springframework.web.util.Log4jConfigListener<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">listener-class</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">listener</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n\n<p>applicationContext.xml就不需要配置了</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>  <br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">beans</span> <span class=\"hljs-attr\">xmlns</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/beans\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xmlns:xsi</span>=<span class=\"hljs-string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span> <span class=\"hljs-attr\">xmlns:context</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/context\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xmlns:aop</span>=<span class=\"hljs-string\">\"http://www.springframework.org/schema/aop\"</span>  </span><br><span class=\"hljs-tag\">    <span class=\"hljs-attr\">xsi:schemaLocation</span>=<span class=\"hljs-string\">\"    </span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/beans</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/beans/spring-beans-3.2.xsd</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/aop</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/aop/spring-aop-3.2.xsd</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">http://www.springframework.org/schema/context</span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\"></span></span><br><span class=\"hljs-tag\"><span class=\"hljs-string\">           http://www.springframework.org/schema/context/spring-context-3.2.xsd\"</span>&gt;</span>  <br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">beans</span>&gt;</span><br></code></pre></td></tr></table></figure>\n\n<p>然后日志就可以随着spring的启动而启动了。</p>\n<p>如果想把日志文件打印到Tomcat日志文件中：<br>log4j.appender.R.File=${catalina.home}/logs/youLogFile.log </p>\n<p>这个方法只能Tomcat使用，其它容器就不行了。</p>","categories":[{"name":"spring","path":"api/categories/spring.json"}],"tags":[{"name":"spring","path":"api/tags/spring.json"},{"name":"log4j","path":"api/tags/log4j.json"}]}