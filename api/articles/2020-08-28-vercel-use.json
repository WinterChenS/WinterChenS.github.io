{"title":"站点托管CDN加速的平台vercel使用之组织免费使用","slug":"2020-08-28-vercel-use","date":"2020-08-28T09:29:00.000Z","updated":"2022-12-01T01:32:39.783Z","comments":true,"path":"api/articles/2020-08-28-vercel-use.json","excerpt":null,"covers":null,"cover":"https://cdn.jsdelivr.net/gh/WinterChenS/img/posts/1628046749195443.jpg","content":"<blockquote>\n<p>vercel是什么？</p>\n</blockquote>\n<h3 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h3><p>vercel是一个站点托管平台，提供CDN加速，同类的平台有Netlify 和 Github Pages，相比之下，vercel国内的访问速度更快，并且提供Production环境和development环境，对于项目开发非常的有用的，并且支持持续集成，一次push或者一次PR会自动化构建发布，发布在development环境，都会生成不一样的链接可供预览。</p>\n<p>但是vercel只是针对个人用户免费，teams是收费的，对于Organization用户来说成本还是挺高的，那么如果在Organization Project在vercel中免费呢？</p>\n<h3 id=\"方案\"><a href=\"#方案\" class=\"headerlink\" title=\"方案\"></a>方案</h3><p>我们可以选择绕过vercel的产品定位策略，vercel提供了CLI生成个人项目，那么我们可以利用github action部署到vercel，下面来讲讲具体的实现方案：</p>\n<p>1.用户将代码push到github；<br>2.触发github action构建，使用vercel的action将当前代码库的文件推送到vercel；<br>3.vercel进行构建部署；</p>\n<h3 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h3><h4 id=\"创建一个项目\"><a href=\"#创建一个项目\" class=\"headerlink\" title=\"创建一个项目\"></a>创建一个项目</h4><p>如果已经存在仓库，clone该仓库到安装过nodejs的电脑，不存在仓库新建一个项目并且push到github。</p>\n<h4 id=\"安装vercel-cli\"><a href=\"#安装vercel-cli\" class=\"headerlink\" title=\"安装vercel cli\"></a>安装vercel cli</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">npm i -g vercel<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"部署项目\"><a href=\"#部署项目\" class=\"headerlink\" title=\"部署项目\"></a>部署项目</h4><p>因为vercel不支持网页端创建项目，只支持CLI创建项目，所以我们这一步的目的就是创建项目，后续的构建和发布直接使用github action 持续集成部署。</p>\n<p>进入项目根目录执行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">vercel<br></code></pre></td></tr></table></figure>\n<p>按照需求进行配置相关信息即可创建项目，最重要的是project.json内的项目相关信息</p>\n<p>会打印出创建的项目相关的信息，orgid 和 projectid （非常重要的参数）</p>\n<h4 id=\"获取相关配置\"><a href=\"#获取相关配置\" class=\"headerlink\" title=\"获取相关配置\"></a>获取相关配置</h4><h5 id=\"github\"><a href=\"#github\" class=\"headerlink\" title=\"github\"></a>github</h5><p><a href=\"https://github.com/settings/tokens\" target=\"_blank\" rel=\"noopener\">获取Github Access Token</a></p>\n<h5 id=\"vercel\"><a href=\"#vercel\" class=\"headerlink\" title=\"vercel\"></a>vercel</h5><p>项目根目录运行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">cat .vercel&#x2F;project.json<br></code></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">&#123;&quot;orgId&quot;:&quot;r359XAnYONVAmiXtdxZ22A2E&quot;,&quot;projectId&quot;:&quot;Qma3GdwoiAfJSsbsSydBgaCDh8LJj6wTWvvqpUwrN6J2F3&quot;&#125;<br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><p>Org ID：标示用户的Id，对应project.json中的orgId</p>\n</li>\n<li><p>Project ID：项目的标示，对应project.json中的projectId</p>\n</li>\n<li><p>Vercel Token： <a href=\"https://vercel.com/account/tokens\" target=\"_blank\" rel=\"noopener\">点击Create</a></p>\n</li>\n</ol>\n<h5 id=\"配置github-Secret\"><a href=\"#配置github-Secret\" class=\"headerlink\" title=\"配置github Secret\"></a>配置github Secret</h5><p>github action可以获取Secret参数，一些敏感信息可以设置到Secret中，并且以变量的方式传入到github action的参数中。</p>\n<p>打开github项目的Setting -&gt; Secret，点击 new secret创建三个配置</p>\n<ul>\n<li>VERCEL_TOKEN：上一步的Vercel Token</li>\n<li>ORG_ID：  上一步的Org ID</li>\n<li>PROJECT_ID：上一步的Project ID</li>\n</ul>\n<p>配置好这些参数就可以进行github action脚本的编写了</p>\n<h4 id=\"编写Github-Action脚本\"><a href=\"#编写Github-Action脚本\" class=\"headerlink\" title=\"编写Github Action脚本\"></a>编写Github Action脚本</h4><p>在github中创建action（具体方法自行搜索）</p>\n<p>使用了<code>amondnet/vercel-action@v19.0.1+3</code> 组件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">- name: Vercel Action<br>      # You may pin to the exact commit or the version.<br>      # uses: amondnet&#x2F;vercel-action@77cb0ce3642a451f7f18d63821c0e26f7adead9a<br>      uses: amondnet&#x2F;vercel-action@v19.0.1+3<br>      with:<br>        # Vercel token<br>        vercel-token: $&#123;&#123; secrets.VERCEL_TOKEN &#125;&#125;<br>        # <br>        # if you want to comment on pr and commit, set token<br>        github-token: $&#123;&#123; secrets.OP_TOKEN &#125;&#125; # optional<br>        # if you want to create github deployment, set true, default: false<br>        github-deployment: false # optional, default is false<br>        # the working directory<br>        working-directory: .&#x2F; # optional<br>        # Vercel CLI 17+, ❗️  The &#96;name&#96; property in vercel.json is deprecated (https:&#x2F;&#x2F;zeit.ink&#x2F;5F)<br>        vercel-project-id: $&#123;&#123; secrets.PROJECT_ID&#125;&#125; # optional<br>        # Vercel CLI 17+, ❗️  The &#96;name&#96; property in vercel.json is deprecated (https:&#x2F;&#x2F;zeit.ink&#x2F;5F)<br>        vercel-org-id: $&#123;&#123; secrets.ORG_ID&#125;&#125; # optional<br>        vercel-args: &#39;--prod&#39; #这是一个关键点，这里执行生产生产环境还是开发环境，默认是测试环境<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"案例\"><a href=\"#案例\" class=\"headerlink\" title=\"案例\"></a>案例</h4><p>完整的案例：<a href=\"https://github.com/sam-bo/blog_back\" target=\"_blank\" rel=\"noopener\">https://github.com/sam-bo/blog_back</a></p>\n<p>案例里面的其它脚本可以忽略，根据实际的情况进行编写。</p>\n<h4 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h4><p>安装上面的步骤，代码提交之后就可以自动构建了，是不是很简单呢？</p>\n<p>vercel在国内的访问速度可以秒杀github pages了，vercel虽然不支持组织，利用这种方式我们可以免费使用。</p>\n","more":"<blockquote>\n<p>vercel是什么？</p>\n</blockquote>\n<h3 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h3><p>vercel是一个站点托管平台，提供CDN加速，同类的平台有Netlify 和 Github Pages，相比之下，vercel国内的访问速度更快，并且提供Production环境和development环境，对于项目开发非常的有用的，并且支持持续集成，一次push或者一次PR会自动化构建发布，发布在development环境，都会生成不一样的链接可供预览。</p>\n<p>但是vercel只是针对个人用户免费，teams是收费的，对于Organization用户来说成本还是挺高的，那么如果在Organization Project在vercel中免费呢？</p>\n<h3 id=\"方案\"><a href=\"#方案\" class=\"headerlink\" title=\"方案\"></a>方案</h3><p>我们可以选择绕过vercel的产品定位策略，vercel提供了CLI生成个人项目，那么我们可以利用github action部署到vercel，下面来讲讲具体的实现方案：</p>\n<p>1.用户将代码push到github；<br>2.触发github action构建，使用vercel的action将当前代码库的文件推送到vercel；<br>3.vercel进行构建部署；</p>\n<h3 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h3><h4 id=\"创建一个项目\"><a href=\"#创建一个项目\" class=\"headerlink\" title=\"创建一个项目\"></a>创建一个项目</h4><p>如果已经存在仓库，clone该仓库到安装过nodejs的电脑，不存在仓库新建一个项目并且push到github。</p>\n<h4 id=\"安装vercel-cli\"><a href=\"#安装vercel-cli\" class=\"headerlink\" title=\"安装vercel cli\"></a>安装vercel cli</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">npm i -g vercel<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"部署项目\"><a href=\"#部署项目\" class=\"headerlink\" title=\"部署项目\"></a>部署项目</h4><p>因为vercel不支持网页端创建项目，只支持CLI创建项目，所以我们这一步的目的就是创建项目，后续的构建和发布直接使用github action 持续集成部署。</p>\n<p>进入项目根目录执行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">vercel<br></code></pre></td></tr></table></figure>\n<p>按照需求进行配置相关信息即可创建项目，最重要的是project.json内的项目相关信息</p>\n<p>会打印出创建的项目相关的信息，orgid 和 projectid （非常重要的参数）</p>\n<h4 id=\"获取相关配置\"><a href=\"#获取相关配置\" class=\"headerlink\" title=\"获取相关配置\"></a>获取相关配置</h4><h5 id=\"github\"><a href=\"#github\" class=\"headerlink\" title=\"github\"></a>github</h5><p><a href=\"https://github.com/settings/tokens\" target=\"_blank\" rel=\"noopener\">获取Github Access Token</a></p>\n<h5 id=\"vercel\"><a href=\"#vercel\" class=\"headerlink\" title=\"vercel\"></a>vercel</h5><p>项目根目录运行</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">cat .vercel&#x2F;project.json<br></code></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">&#123;&quot;orgId&quot;:&quot;r359XAnYONVAmiXtdxZ22A2E&quot;,&quot;projectId&quot;:&quot;Qma3GdwoiAfJSsbsSydBgaCDh8LJj6wTWvvqpUwrN6J2F3&quot;&#125;<br></code></pre></td></tr></table></figure>\n\n<ol>\n<li><p>Org ID：标示用户的Id，对应project.json中的orgId</p>\n</li>\n<li><p>Project ID：项目的标示，对应project.json中的projectId</p>\n</li>\n<li><p>Vercel Token： <a href=\"https://vercel.com/account/tokens\" target=\"_blank\" rel=\"noopener\">点击Create</a></p>\n</li>\n</ol>\n<h5 id=\"配置github-Secret\"><a href=\"#配置github-Secret\" class=\"headerlink\" title=\"配置github Secret\"></a>配置github Secret</h5><p>github action可以获取Secret参数，一些敏感信息可以设置到Secret中，并且以变量的方式传入到github action的参数中。</p>\n<p>打开github项目的Setting -&gt; Secret，点击 new secret创建三个配置</p>\n<ul>\n<li>VERCEL_TOKEN：上一步的Vercel Token</li>\n<li>ORG_ID：  上一步的Org ID</li>\n<li>PROJECT_ID：上一步的Project ID</li>\n</ul>\n<p>配置好这些参数就可以进行github action脚本的编写了</p>\n<h4 id=\"编写Github-Action脚本\"><a href=\"#编写Github-Action脚本\" class=\"headerlink\" title=\"编写Github Action脚本\"></a>编写Github Action脚本</h4><p>在github中创建action（具体方法自行搜索）</p>\n<p>使用了<code>amondnet/vercel-action@v19.0.1+3</code> 组件</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs plain\">- name: Vercel Action<br>      # You may pin to the exact commit or the version.<br>      # uses: amondnet&#x2F;vercel-action@77cb0ce3642a451f7f18d63821c0e26f7adead9a<br>      uses: amondnet&#x2F;vercel-action@v19.0.1+3<br>      with:<br>        # Vercel token<br>        vercel-token: $&#123;&#123; secrets.VERCEL_TOKEN &#125;&#125;<br>        # <br>        # if you want to comment on pr and commit, set token<br>        github-token: $&#123;&#123; secrets.OP_TOKEN &#125;&#125; # optional<br>        # if you want to create github deployment, set true, default: false<br>        github-deployment: false # optional, default is false<br>        # the working directory<br>        working-directory: .&#x2F; # optional<br>        # Vercel CLI 17+, ❗️  The &#96;name&#96; property in vercel.json is deprecated (https:&#x2F;&#x2F;zeit.ink&#x2F;5F)<br>        vercel-project-id: $&#123;&#123; secrets.PROJECT_ID&#125;&#125; # optional<br>        # Vercel CLI 17+, ❗️  The &#96;name&#96; property in vercel.json is deprecated (https:&#x2F;&#x2F;zeit.ink&#x2F;5F)<br>        vercel-org-id: $&#123;&#123; secrets.ORG_ID&#125;&#125; # optional<br>        vercel-args: &#39;--prod&#39; #这是一个关键点，这里执行生产生产环境还是开发环境，默认是测试环境<br></code></pre></td></tr></table></figure>\n\n<h4 id=\"案例\"><a href=\"#案例\" class=\"headerlink\" title=\"案例\"></a>案例</h4><p>完整的案例：<a href=\"https://github.com/sam-bo/blog_back\" target=\"_blank\" rel=\"noopener\">https://github.com/sam-bo/blog_back</a></p>\n<p>案例里面的其它脚本可以忽略，根据实际的情况进行编写。</p>\n<h4 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h4><p>安装上面的步骤，代码提交之后就可以自动构建了，是不是很简单呢？</p>\n<p>vercel在国内的访问速度可以秒杀github pages了，vercel虽然不支持组织，利用这种方式我们可以免费使用。</p>\n","categories":[{"name":"github","path":"api/categories/github.json"}],"tags":[{"name":"share","path":"api/tags/share.json"}]}